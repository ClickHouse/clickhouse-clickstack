(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3172],{8989:(e,t,a)=>{"use strict";a.d(t,{R:()=>c});var n=a(75155),r=a(67270),s=a(12482),l=a(49672),o=a(81973),i=a(78550);function c(e,t){let a,c,d,m,u,h=(0,n.c)(16);h[0]!==e?(a={...e,with:void 0},h[0]=e,h[1]=a):a=h[1];let x=a,p=(0,l.fu)(),b=(0,i.Ge)(),f=x?.source;h[2]!==f?(c={id:f},h[2]=f,h[3]=c):c=h[3];let{data:g,isLoading:j}=(0,o.Fo)(c);h[4]!==x?(d=["explain",x],h[4]=x,h[5]=d):d=h[5],h[6]!==p||h[7]!==x||h[8]!==b||h[9]!==g?.querySettings?(m=async e=>{let{signal:t}=e,a=await (0,r.PV)(x,b,g?.querySettings);return(await p.query({query:`EXPLAIN ESTIMATE ${a.sql}`,query_params:a.params,format:"JSONEachRow",abort_signal:t,connectionId:x.connection})).json()},h[6]=p,h[7]=x,h[8]=b,h[9]=g?.querySettings,h[10]=m):m=h[10];let y=!j;return h[11]!==t||h[12]!==d||h[13]!==m||h[14]!==y?(u={queryKey:d,queryFn:m,retry:!1,staleTime:6e4,enabled:y,...t},h[11]=t,h[12]=d,h[13]=m,h[14]=y,h[15]=u):u=h[15],(0,s.I)(u)}},24207:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var n=a(6029),r=a(75155),s=a(56513),l=a(25062),o=a(90993);function i(e){let t,a,i,c=(0,r.c)(4),{onDelete:d}=e;return c[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,n.jsx)(s.W.Target,{children:(0,n.jsx)(l.$,{variant:"danger",size:"xs",children:"Delete"})}),c[0]=t):t=c[0],c[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,n.jsx)(o.A,{size:16}),c[1]=a):a=c[1],c[2]!==d?(i=(0,n.jsxs)(s.W,{withArrow:!0,children:[t,(0,n.jsx)(s.W.Dropdown,{children:(0,n.jsx)(s.W.Item,{leftSection:a,onClick:d,children:"Confirm Delete"})})]}),c[2]=d,c[3]=i):i=c[3],i}},24314:(e,t,a)=>{"use strict";a.d(t,{Eb:()=>eH});var n=a(6029),r=a(75155),s=a(55729),l=a(1909),o=a(35467),i=a(82641),c=a(43517),d=a(34834),m=a(63085),u=a(53061),h=a(78253),x=a(60481),p=a(48378),b=a(76013),f=a(25062),g=a(3635),j=a(92789),y=a(38206),S=a(23935),v=a(9953),w=a(18341),C=a(58061),E=a(289),N=a(3465),_=a(60665),z=a(97702),T=a(90515),A=a(90993),$=a(28975),k=a(95316),I=a(57478),F=a(98142),H=a(93108),L=a(8989),V=a(78550),D=a(81973),M=a(76089);let Z=["avg","count","max","min","quantile","sum","histogram"],q=[{value:"1 second",label:"1 second"},{value:M.Z7.FifteenSecond,label:"15 seconds"},{value:M.Z7.ThirtySecond,label:"30 seconds"},{value:M.Z7.OneMinute,label:"1 minute"},{value:M.Z7.FiveMinute,label:"5 minutes"},{value:M.Z7.FifteenMinute,label:"15 minutes"},{value:M.Z7.ThirtyMinute,label:"30 minutes"},{value:M.Z7.OneHour,label:"1 hour"},{value:M.Z7.TwoHour,label:"2 hours"},{value:M.Z7.SixHour,label:"6 hours"},{value:M.Z7.TwelveHour,label:"12 hours"},{value:M.Z7.OneDay,label:"1 day"},{value:M.Z7.TwoDay,label:"2 days"},{value:M.Z7.SevenDay,label:"7 days"},{value:M.Z7.ThirtyDay,label:"30 days"}],O=/MATERIALIZED VIEW [^\s]+\.[^\s]+ TO ([^\s]+)\.([^\s]+)/;function G(e){return e.engine?.includes("AggregatingMergeTree")??!1}function B(e){return e.engine?.includes("SummingMergeTree")??!1}async function R({databaseName:e,tableName:t,connectionId:a},n){try{let r=await n.getTableMetadata({databaseName:e,tableName:t,connectionId:a});if(r.engine?.startsWith("MaterializedView")){let e=function(e){let t=e.create_table_query.match(O);if(t&&t[1]&&t[2])return{databaseName:t[1],tableName:t[2]}}(r);if(e){let t=await n.getTableMetadata({...e,connectionId:a});return G(t)||B(t)?{mvMetadata:r,mvTableMetadata:t}:void 0}}else if(G(r)||B(r)){let s=await n.queryMaterializedViewsByTarget({databaseName:e,tableName:t,connectionId:a});if(1===s.length)return{mvMetadata:await n.getTableMetadata({...s[0],connectionId:a}),mvTableMetadata:r};return{mvTableMetadata:r}}}catch(e){console.error("Error fetching materialized view metadata",e)}}function P(e){let t=e.as_select??"",a=t.slice(0,t.toLowerCase().indexOf("from")).replace(/^select/i,"").trim();return(0,M.AB)(a)}function Y(e,t,a,n){if("count"===e)return"";let r=t.name.split("__")[1];if(a.find(e=>e.name===r))return r;if(n){let e=P(n).find(e=>e.endsWith(t.name)),r=e&&a.find(t=>RegExp(`\\b${t.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`).test(e));if(r)return r.name}return""}async function K(e,t,a){let{databaseName:n,tableName:r,connectionId:s}=e,{databaseName:l,tableName:i}=t;if(!r)return;let c=await R({databaseName:n,tableName:r,connectionId:s},a);if(!c)return;let{mvMetadata:d,mvTableMetadata:m}=c,[u,h]=await Promise.all([a.getColumns({databaseName:m.database,tableName:m.name,connectionId:s}),a.getColumns({databaseName:l,tableName:i,connectionId:s})]),x=u.filter(e=>e.type.includes("AggregateFunction")).map(e=>{let t,a=e.type.match(/AggregateFunction\(([a-zA-Z0-9_]+)/)?.[1];if("sum"===a&&e.name.toLowerCase().includes("count")?a="count":a?.startsWith("quantile")&&(a="quantile"),t=a,!Z.includes(t??""))return;let n=Y(a,e,h,d);return{mvColumn:e.name,aggFn:a,sourceColumn:n}}).filter(e=>void 0!=e),p=B(m)?function(e){if(!B(e))return;let t=e.engine_full?.match(/SummingMergeTree\((\(?[^(]*)\)/)?.[1],a=t?.at(0)==="("&&t?.at(-1)===")"?t.slice(1,-1):t;if(a)return new Set((0,M.AB)(a))}(m):void 0;for(let e of p??[]){let t=e.toLowerCase().includes("count")?"count":"sum",a=u.find(t=>t.name===e);if(a){let n=Y(t,a,h,d);x.push({mvColumn:e,aggFn:t,sourceColumn:n})}}let b=new Set((0,o.bZ)(m.primary_key)),f=(0,o.P1)(u,[o.A2.Date])??[],g=f?.find(e=>b.has(e.name))?.name??"",j="";d&&(j=function(e,t){try{let a=P(e).find(e=>e.match(/toStartOf|toDate/)&&e.includes(t));if(!a)return;for(let[e,t]of Object.entries({toStartOfSecond:"1 second",toStartOfMinute:"1 minute",toStartOfFiveMinutes:"5 minute",toStartOfFifteenMinutes:"15 minute",toStartOfHour:"1 hour",toStartOfDay:"1 day",toDate:"1 day",toDateTime:"1 second"}))if(a?.includes(`${e}(`))return t;if(a.includes("toStartOfInterval(")){let e=a.match(/INTERVAL\s+(\d+)\s+(SECOND|MINUTE|HOUR|DAY)S?\)/i),t=a.match(/toInterval(Second|Minute|Hour|Day)\((\d+)\)/),n=e?`${e[1]} ${e[2].toLowerCase()}`:t?`${t[2]} ${t[1].toLowerCase()}`:null;if(n&&q.map(e=>e.value).includes(n)&&q.map(e=>e.value).includes(n))return n}}catch(e){console.error("Error inferring timestamp column granularity",e)}}(d,g)??"");let y=u.filter(e=>!e.type.includes("AggregateFunction")&&!p?.has(e.name)&&!f.includes(e)).map(e=>e.name).join(", ");return{databaseName:m.database,tableName:m.name,dimensionColumns:y,minGranularity:j,timestampColumn:g,aggregatedColumns:x}}var W=a(24207),X=a(62453),U=a(66980),Q=a(49672);function J(e){let t,a,s,l,o,i,c,d,m=(0,r.c)(21),{database:u,setDatabase:h,connectionId:x,onBlur:p,name:b,inputRef:f,size:g}=e,j=x??"";m[0]!==j?(t={connectionId:j},m[0]=j,m[1]=t):t=m[1];let S=!!x;m[2]!==S?(a={enabled:S},m[2]=S,m[3]=a):a=m[3];let{data:v,isLoading:w}=(0,Q.VH)(t,a);m[4]!==v?.data?(s=v?.data||[],m[4]=v?.data,m[5]=s):s=m[5],m[6]!==s?(l=s.map(ee),m[6]=s,m[7]=l):l=m[7];let C=l;return m[8]===Symbol.for("react.memo_cache_sentinel")?(o=(0,n.jsx)(U.A,{size:16}),m[8]=o):o=m[8],m[9]===Symbol.for("react.memo_cache_sentinel")?(i={withinPortal:!1},m[9]=i):i=m[9],m[10]!==h?(c=e=>h(e??void 0),m[10]=h,m[11]=c):c=m[11],m[12]!==C||m[13]!==u||m[14]!==f||m[15]!==w||m[16]!==b||m[17]!==p||m[18]!==g||m[19]!==c?(d=(0,n.jsx)(y.l,{searchable:!0,placeholder:"Database",leftSection:o,maxDropdownHeight:280,data:C,disabled:w,comboboxProps:i,value:u,onChange:c,onBlur:p,name:b,ref:f,size:g}),m[12]=C,m[13]=u,m[14]=f,m[15]=w,m[16]=b,m[17]=p,m[18]=g,m[19]=c,m[20]=d):d=m[20],d}function ee(e){return{value:e.name,label:e.name}}function et(e){let t,a=(0,r.c)(7),{field:s}=(0,l.as)(e);return a[0]!==s.name||a[1]!==s.onBlur||a[2]!==s.onChange||a[3]!==s.ref||a[4]!==s.value||a[5]!==e?(t=(0,n.jsx)(J,{...e,database:s.value,setDatabase:s.onChange,onBlur:s.onBlur,name:s.name,inputRef:s.ref}),a[0]=s.name,a[1]=s.onBlur,a[2]=s.onChange,a[3]=s.ref,a[4]=s.value,a[5]=e,a[6]=t):t=a[6],t}var ea=a(45519),en=a(86761);function er(e){let t,a,s,l,o,i,c,d,m,u,x=(0,r.c)(29),{database:p,setTable:b,table:f,onBlur:g,name:j,size:S,inputRef:v,connectionId:w}=e,C=p??"",E=w??"";x[0]!==C||x[1]!==E?(t={database:C,connectionId:E},x[0]=C,x[1]=E,x[2]=t):t=x[2];let N=!!p&&!!w;x[3]!==N?(a={enabled:N},x[3]=N,x[4]=a):a=x[4];let{data:_,isLoading:z}=(0,Q.uI)(t,a);x[5]!==_?.data?(s=_?.data||[],x[5]=_?.data,x[6]=s):s=x[6],x[7]!==s?(l=s.map(es),x[7]=s,x[8]=l):l=x[8];let T=l;x[9]!==w||x[10]!==p||x[11]!==f?(o=w&&p&&f?(0,n.jsx)(en.A,{source:{connection:w,from:{databaseName:p,tableName:f}},variant:"text"}):void 0,x[9]=w,x[10]=p,x[11]=f,x[12]=o):o=x[12],x[13]!==o?(i=(0,I.J)({sourceSchemaPreview:o}),x[13]=o,x[14]=i):i=x[14];let A=i;return x[15]===Symbol.for("react.memo_cache_sentinel")?(c=(0,n.jsx)(ea.A,{size:16}),x[15]=c):c=x[15],x[16]===Symbol.for("react.memo_cache_sentinel")?(d={withinPortal:!1},x[16]=d):d=x[16],x[17]!==b?(m=e=>b(e??void 0),x[17]=b,x[18]=m):m=x[18],x[19]!==T||x[20]!==v||x[21]!==z||x[22]!==j||x[23]!==g||x[24]!==A||x[25]!==S||x[26]!==m||x[27]!==f?(u=(0,n.jsx)(h.s,{align:"center",gap:8,children:(0,n.jsx)(y.l,{searchable:!0,placeholder:"Table",leftSection:c,maxDropdownHeight:280,data:T,disabled:z,value:f,comboboxProps:d,onChange:m,onBlur:g,name:j,ref:v,size:S,className:"flex-grow-1",...A})}),x[19]=T,x[20]=v,x[21]=z,x[22]=j,x[23]=g,x[24]=A,x[25]=S,x[26]=m,x[27]=f,x[28]=u):u=x[28],u}function es(e){return{value:e.name,label:e.name}}function el(e){let t,a,s,o,i=(0,r.c)(13);i[0]!==e?({database:a,connectionId:t,...s}=e,i[0]=e,i[1]=t,i[2]=a,i[3]=s):(t=i[1],a=i[2],s=i[3]);let{field:c}=(0,l.as)(s);return i[4]!==t||i[5]!==a||i[6]!==c.name||i[7]!==c.onBlur||i[8]!==c.onChange||i[9]!==c.ref||i[10]!==c.value||i[11]!==s?(o=(0,n.jsx)(er,{...s,database:a,connectionId:t,table:c.value,setTable:c.onChange,onBlur:c.onBlur,name:c.name,inputRef:c.ref}),i[4]=t,i[5]=a,i[6]=c.name,i[7]=c.onBlur,i[8]=c.onChange,i[9]=c.ref,i[10]=c.value,i[11]=s,i[12]=o):o=i[12],o}var eo=a(24589),ei=a(22599),ec=a(70114),ed=a(18205);function em(e){let t,a,l,o,i,c,d,m,u=(0,r.c)(16),{summary:h,details:x}=e,[p,b]=(0,s.useState)(!1);u[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>b(eu),u[0]=t):t=u[0];let g=p?"rotate(90deg)":"rotate(0deg)";return u[1]!==g?(a=(0,n.jsx)(ec.A,{size:14,style:{transform:g,transition:"transform 150ms ease"}}),u[1]=g,u[2]=a):a=u[2],u[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,n.jsx)(ed.A,{size:14,className:"me-2"}),u[3]=l):l=u[3],u[4]!==h||u[5]!==a?(o=(0,n.jsxs)(f.$,{variant:"subtle",size:"compact-xs",color:"red",onClick:t,leftSection:a,children:[l," ",h]}),u[4]=h,u[5]=a,u[6]=o):o=u[6],u[7]===Symbol.for("react.memo_cache_sentinel")?(i={whiteSpace:"pre-wrap",wordBreak:"break-word"},u[7]=i):i=u[7],u[8]!==x?(c=(0,n.jsx)(eo.C,{block:!0,c:"red",mt:"xs",style:i,children:x}),u[8]=x,u[9]=c):c=u[9],u[10]!==p||u[11]!==c?(d=(0,n.jsx)(ei.S,{in:p,children:c}),u[10]=p,u[11]=c,u[12]=d):d=u[12],u[13]!==o||u[14]!==d?(m=(0,n.jsxs)(n.Fragment,{children:[o,d]}),u[13]=o,u[14]=d,u[15]=m):m=u[15],m}function eu(e){return!e}var eh=a(71781),ex=a(9211),ep=a(64467);let eb="default",ef=Z.map(e=>({value:e,label:e})),eg={timestampValueExpression:"TimeUnix",resourceAttributesExpression:"ResourceAttributes"},ej={[i.GL.Log]:{metricSourceId:[{targetKind:i.GL.Metric,targetField:"logSourceId"}],traceSourceId:[{targetKind:i.GL.Trace,targetField:"logSourceId"}]},[i.GL.Trace]:{logSourceId:[{targetKind:i.GL.Log,targetField:"traceSourceId"}],sessionSourceId:[{targetKind:i.GL.Session,targetField:"traceSourceId"}],metricSourceId:[{targetKind:i.GL.Metric,targetField:"logSourceId"}]},[i.GL.Session]:{traceSourceId:[{targetKind:i.GL.Trace,targetField:"sessionSourceId"}]},[i.GL.Metric]:{logSourceId:[{targetKind:i.GL.Log,targetField:"metricSourceId"}]}};function ey(e){let t,a,s,l,o,i,p,b,f,g,j,y=(0,r.c)(22),{label:S,children:v,helpText:w}=e;return y[0]===Symbol.for("react.memo_cache_sentinel")?(t={maxWidth:220,minWidth:220,height:"36px"},y[0]=t):t=y[0],y[1]!==S?(a="string"==typeof S?(0,n.jsx)(c.E,{tt:"capitalize",size:"sm",children:S}):S,y[1]=S,y[2]=a):a=y[2],y[3]!==a?(s=(0,n.jsx)(d.B,{justify:"center",style:t,children:a}),y[3]=a,y[4]=s):s=y[4],y[5]!==w?(l={...!w?{opacity:0,pointerEvents:"none"}:{}},y[5]=w,y[6]=l):l=y[6],y[7]===Symbol.for("react.memo_cache_sentinel")?(o=(0,n.jsx)(z.A,{size:20,className:"cursor-pointer"}),y[7]=o):o=y[7],y[8]!==w?(i=(0,n.jsx)(m.m,{label:w,color:"dark",c:"white",multiline:!0,maw:600,children:o}),y[8]=w,y[9]=i):i=y[9],y[10]!==l||y[11]!==i?(p=(0,n.jsx)(u.o,{me:"sm",ms:"sm",style:l,children:i}),y[10]=l,y[11]=i,y[12]=p):p=y[12],y[13]!==s||y[14]!==p?(b=(0,n.jsxs)(h.s,{align:"center",children:[s,p]}),y[13]=s,y[14]=p,y[15]=b):b=y[15],y[16]===Symbol.for("react.memo_cache_sentinel")?(f={minWidth:0},y[16]=f):f=y[16],y[17]!==v?(g=(0,n.jsx)(x.a,{w:"100%",style:f,children:v}),y[17]=v,y[18]=g):g=y[18],y[19]!==g||y[20]!==b?(j=(0,n.jsxs)(h.s,{align:"flex-start",children:[b,g]}),y[19]=g,y[20]=b,y[21]=j):j=y[21],j}function eS(e){let t,a,i,d,u,x,f,g,j,y,S,v,w,C,_,$,k,I,F,H,V,D,M,Z,q,O,G=(0,r.c)(75),{id:B,index:R,control:P,databaseName:Y,name:K,tableName:W,connectionId:X,removeHighlightedAttribute:U}=e,Q=`${K}.${R}.sqlExpression`;G[0]!==P||G[1]!==Q?(t={control:P,name:Q},G[0]=P,G[1]=Q,G[2]=t):t=G[2];let J=(0,l.FH)(t),ee=`${K}.${R}.alias`;G[3]!==P||G[4]!==ee?(a={control:P,name:ee},G[3]=P,G[4]=ee,G[5]=a):a=G[5];let et=(0,l.FH)(a),[ea,en]=(0,s.useState)();G[6]===Symbol.for("react.memo_cache_sentinel")?(i=e=>{en(e)},G[6]=i):i=G[6];let er=(0,E.Y)(i,1e3);G[7]!==et||G[8]!==J||G[9]!==er?(d=()=>{er({expression:J,alias:et})},G[7]=et,G[8]=J,G[9]=er,G[10]=d):d=G[10],G[11]!==et||G[12]!==J?(u=[J,et],G[11]=et,G[12]=J,G[13]=u):u=G[13],(0,N.C)(d,u),G[14]!==Y||G[15]!==W?(x={databaseName:Y,tableName:W},G[14]=Y,G[15]=W,G[16]=x):x=G[16];let es=ea?.alias,el=ea?.expression??"";G[17]!==el||G[18]!==es?(f=[{alias:es,valueExpression:el}],G[17]=el,G[18]=es,G[19]=f):f=G[19],G[20]!==X||G[21]!==f||G[22]!==x?(g={from:x,connection:X,select:f,where:""},G[20]=X,G[21]=f,G[22]=x,G[23]=g):g=G[23];let eo=!!ea?.expression;G[24]!==eo?(j={enabled:eo},G[24]=eo,G[25]=j):j=G[25];let{data:ei,error:ec,isLoading:ed}=(0,L.R)(g,j);G[26]!==et||G[27]!==J?(y=()=>{en({expression:J,alias:et})},G[26]=et,G[27]=J,G[28]=y):y=G[28];let eu=y,ex=!!ei?.length,eb=ec instanceof o.p1,ef=ea?.expression===J&&ea?.alias===et&&(ex||eb);G[29]===Symbol.for("react.memo_cache_sentinel")?(S={display:"contents"},G[29]=S):S=G[29];let eg=`${K}.${R}.sqlExpression`;G[30]!==X||G[31]!==Y||G[32]!==W?(v={databaseName:Y,tableName:W,connectionId:X},G[30]=X,G[31]=Y,G[32]=W,G[33]=v):v=G[33];let ej=`${K}.${R}.sqlExpression`;G[34]!==P||G[35]!==v||G[36]!==ej?(w=(0,n.jsx)(ep.Z,{tableConnection:v,control:P,name:ej,disableKeywordAutocomplete:!0,placeholder:"ResourceAttributes['http.host']"}),G[34]=P,G[35]=v,G[36]=ej,G[37]=w):w=G[37],G[38]!==eg||G[39]!==w?(C=(0,n.jsx)(p.x.Col,{span:3,pe:0,children:(0,n.jsx)("div",{style:S,"data-name":eg,children:w})}),G[38]=eg,G[39]=w,G[40]=C):C=G[40],G[41]===Symbol.for("react.memo_cache_sentinel")?(_=(0,n.jsx)(c.E,{c:"gray",children:"AS"}),G[41]=_):_=G[41];let ey=`${K}.${R}.alias`;G[42]!==P||G[43]!==ey?($=(0,n.jsx)(ep.Z,{control:P,name:ey,placeholder:"Optional Alias",disableKeywordAutocomplete:!0}),G[42]=P,G[43]=ey,G[44]=$):$=G[44];let eS=!J||ed;G[45]===Symbol.for("react.memo_cache_sentinel")?(k=(0,n.jsx)(T.A,{size:16}),G[45]=k):k=G[45],G[46]!==ed||G[47]!==eu||G[48]!==eS?(I=(0,n.jsx)(m.m,{label:"Validate expression",children:(0,n.jsx)(b.M,{size:"xs",variant:"subtle",color:"gray",loading:ed,disabled:eS,onClick:eu,children:k})}),G[46]=ed,G[47]=eu,G[48]=eS,G[49]=I):I=G[49],G[50]!==R||G[51]!==U?(F=()=>U(R),G[50]=R,G[51]=U,G[52]=F):F=G[52],G[53]===Symbol.for("react.memo_cache_sentinel")?(H=(0,n.jsx)(A.A,{size:16}),G[53]=H):H=G[53],G[54]!==F?(V=(0,n.jsx)(b.M,{size:"xs",variant:"subtle",color:"gray",onClick:F,children:H}),G[54]=F,G[55]=V):V=G[55],G[56]!==$||G[57]!==I||G[58]!==V?(D=(0,n.jsx)(p.x.Col,{span:2,ps:"xs",children:(0,n.jsxs)(h.s,{align:"center",gap:"sm",children:[_,$,I,V]})}),G[56]=$,G[57]=I,G[58]=V,G[59]=D):D=G[59],G[60]!==ec?.message||G[61]!==eb||G[62]!==ex||G[63]!==ef?(M=ef&&(0,n.jsxs)(p.x.Col,{span:5,pe:0,pt:0,children:[ex&&(0,n.jsx)(c.E,{c:"green",size:"xs",children:"Expression is valid."}),eb&&(0,n.jsx)(em,{summary:"Expression is invalid",details:ec?.message})]}),G[60]=ec?.message,G[61]=eb,G[62]=ex,G[63]=ef,G[64]=M):M=G[64];let ev=`${K}.${R}.luceneExpression`;return G[65]!==P||G[66]!==ev?(Z=(0,n.jsx)(p.x.Col,{span:3,pe:0,children:(0,n.jsx)(eh.t4,{control:P,name:ev,placeholder:"ResourceAttributes.http.host (Optional) "})}),G[65]=P,G[66]=ev,G[67]=Z):Z=G[67],G[68]===Symbol.for("react.memo_cache_sentinel")?(q=(0,n.jsx)(p.x.Col,{span:1,pe:0,children:(0,n.jsx)(c.E,{me:"sm",mt:6,children:(0,n.jsx)(m.m,{label:"An optional, Lucene version of the above expression. If provided, it is used when searching for this attribute value.",color:"dark",c:"white",multiline:!0,maw:600,children:(0,n.jsx)(z.A,{size:14,className:"cursor-pointer"})})})}),G[68]=q):q=G[68],G[69]!==B||G[70]!==C||G[71]!==D||G[72]!==M||G[73]!==Z?(O=(0,n.jsxs)(s.Fragment,{children:[C,D,M,Z,q]},B),G[69]=B,G[70]=C,G[71]=D,G[72]=M,G[73]=Z,G[74]=O):O=G[74],O}function ev(e){let t,a,s,o,i,c,d,m,u,h,x=(0,r.c)(37),{control:b,name:g,label:j,helpText:y}=e;x[0]!==b?(t={control:b,name:"from.databaseName",defaultValue:eb},x[0]=b,x[1]=t):t=x[1];let S=(0,l.FH)(t);x[2]!==b?(a={control:b,name:"from.tableName"},x[2]=b,x[3]=a):a=x[3];let v=(0,l.FH)(a);x[4]!==b?(s={control:b,name:"connection"},x[4]=b,x[5]=s):s=x[5];let w=(0,l.FH)(s);x[6]!==b||x[7]!==g?(o={control:b,name:g},x[6]=b,x[7]=g,x[8]=o):o=x[8];let{fields:C,append:E,remove:N}=(0,l.jz)(o);if(x[9]!==w||x[10]!==b||x[11]!==S||x[12]!==C||x[13]!==g||x[14]!==N||x[15]!==v){let e;x[17]!==w||x[18]!==b||x[19]!==S||x[20]!==g||x[21]!==N||x[22]!==v?(e=(e,t)=>{let{id:a}=e;return(0,n.jsx)(eS,{id:a,index:t,name:g,control:b,databaseName:S,tableName:v,connectionId:w,removeHighlightedAttribute:N},a)},x[17]=w,x[18]=b,x[19]=S,x[20]=g,x[21]=N,x[22]=v,x[23]=e):e=x[23],i=C.map(e),x[9]=w,x[10]=b,x[11]=S,x[12]=C,x[13]=g,x[14]=N,x[15]=v,x[16]=i}else i=x[16];x[24]!==i?(c=(0,n.jsx)(p.x,{columns:5,children:i}),x[24]=i,x[25]=c):c=x[25];let _=C.length?"sm":"md";return x[26]!==E?(d=()=>{E({sqlExpression:"",luceneExpression:"",alias:""},{shouldFocus:!1})},x[26]=E,x[27]=d):d=x[27],x[28]===Symbol.for("react.memo_cache_sentinel")?(m=(0,n.jsx)($.A,{size:14,className:"me-2"}),x[28]=m):m=x[28],x[29]!==_||x[30]!==d?(u=(0,n.jsxs)(f.$,{variant:"secondary",size:"sm",className:"align-self-start",mt:_,onClick:d,children:[m,"Add expression"]}),x[29]=_,x[30]=d,x[31]=u):u=x[31],x[32]!==y||x[33]!==j||x[34]!==u||x[35]!==c?(h=(0,n.jsxs)(ey,{label:j,helpText:y,children:[c,u]}),x[32]=y,x[33]=j,x[34]=u,x[35]=c,x[36]=h):h=x[36],h}function ew(e){let t,a,s,o,i,c,m,u=(0,r.c)(22),{control:h,setValue:x}=e;u[0]!==h?(t={control:h,name:"from.databaseName",defaultValue:eb},u[0]=h,u[1]=t):t=u[1];let p=(0,l.FH)(t);u[2]!==h?(a={control:h,name:"materializedViews"},u[2]=h,u[3]=a):a=u[3];let{fields:b,append:j,remove:y}=(0,l.jz)(a);if(u[4]!==h||u[5]!==b||u[6]!==y||u[7]!==x){let e;u[9]!==h||u[10]!==y||u[11]!==x?(e=(e,t)=>(0,n.jsx)(eC,{control:h,mvIndex:t,setValue:x,onRemove:()=>y(t)},e.id),u[9]=h,u[10]=y,u[11]=x,u[12]=e):e=u[12],s=b.map(e),u[4]=h,u[5]=b,u[6]=y,u[7]=x,u[8]=s}else s=u[8];return u[13]!==j||u[14]!==p?(o=()=>{j({databaseName:p,tableName:"",dimensionColumns:"",minGranularity:"",timestampColumn:"",aggregatedColumns:[]})},u[13]=j,u[14]=p,u[15]=o):o=u[15],u[16]===Symbol.for("react.memo_cache_sentinel")?(i=(0,n.jsxs)(g.Y,{children:[(0,n.jsx)($.A,{size:16}),"Add Materialized View"]}),u[16]=i):i=u[16],u[17]!==o?(c=(0,n.jsx)(f.$,{variant:"secondary",onClick:o,children:i}),u[17]=o,u[18]=c):c=u[18],u[19]!==s||u[20]!==c?(m=(0,n.jsx)(d.B,{gap:"md",children:(0,n.jsx)(ey,{label:"Materialized Views",helpText:"Configure materialized views for query optimization. These pre-aggregated views can significantly improve query performance on aggregation queries.",children:(0,n.jsxs)(d.B,{gap:"md",children:[s,c]})})}),u[19]=s,u[20]=c,u[21]=m):m=u[21],m}function eC(e){let t,a,s,o,i,u,h,f,y,S,v,w,C,E,N,_,T,$,k,I,F,H,L,V=(0,r.c)(67),{control:D,mvIndex:M,onRemove:Z,setValue:q}=e;V[0]!==D?(t={control:D,name:"connection"},V[0]=D,V[1]=t):t=V[1];let O=(0,l.FH)(t);V[2]!==D?(a={control:D,name:"from.databaseName",defaultValue:eb},V[2]=D,V[3]=a):a=V[3];let G=(0,l.FH)(a),B=`materializedViews.${M}.databaseName`;V[4]!==D||V[5]!==G||V[6]!==B?(s={control:D,name:B,defaultValue:G},V[4]=D,V[5]=G,V[6]=B,V[7]=s):s=V[7];let R=(0,l.FH)(s),P=`materializedViews.${M}.tableName`;V[8]!==D||V[9]!==P?(o={control:D,name:P,defaultValue:""},V[8]=D,V[9]=P,V[10]=o):o=V[10];let Y=(0,l.FH)(o),K=`materializedViews.${M}.databaseName`;V[11]!==O||V[12]!==D||V[13]!==K?(i=(0,n.jsx)(p.x.Col,{span:1,children:(0,n.jsx)(et,{control:D,name:K,connectionId:O})}),V[11]=O,V[12]=D,V[13]=K,V[14]=i):i=V[14];let W=`materializedViews.${M}.tableName`;V[15]!==O||V[16]!==D||V[17]!==R||V[18]!==W?(u=(0,n.jsx)(x.a,{flex:1,children:(0,n.jsx)(el,{database:R,control:D,name:W,connectionId:O})}),V[15]=O,V[16]=D,V[17]=R,V[18]=W,V[19]=u):u=V[19],V[20]===Symbol.for("react.memo_cache_sentinel")?(h=(0,n.jsx)(A.A,{size:16}),V[20]=h):h=V[20],V[21]!==Z?(f=(0,n.jsx)(b.M,{size:"sm",onClick:Z,children:h}),V[21]=Z,V[22]=f):f=V[22],V[23]!==u||V[24]!==f?(y=(0,n.jsx)(p.x.Col,{span:1,children:(0,n.jsxs)(g.Y,{children:[u,f]})}),V[23]=u,V[24]=f,V[25]=y):y=V[25],V[26]===Symbol.for("react.memo_cache_sentinel")?(S=(0,n.jsx)(c.E,{size:"xs",fw:500,mb:4,children:"Timestamp Column"}),V[26]=S):S=V[26],V[27]!==O||V[28]!==R||V[29]!==Y?(v={databaseName:R,tableName:Y,connectionId:O},V[27]=O,V[28]=R,V[29]=Y,V[30]=v):v=V[30];let X=`materializedViews.${M}.timestampColumn`;V[31]!==D||V[32]!==v||V[33]!==X?(w=(0,n.jsxs)(p.x.Col,{span:2,children:[S,(0,n.jsx)(ep.Z,{tableConnection:v,control:D,placeholder:"Timestamp",name:X,disableKeywordAutocomplete:!0})]}),V[31]=D,V[32]=v,V[33]=X,V[34]=w):w=V[34],V[35]===Symbol.for("react.memo_cache_sentinel")?(C=(0,n.jsxs)(c.E,{size:"xs",fw:500,mb:4,children:["Granularity",(0,n.jsx)(m.m,{label:"The granularity of the timestamp column",color:"dark",c:"white",multiline:!0,maw:600,children:(0,n.jsx)(z.A,{size:14,className:"cursor-pointer ms-1"})})]}),V[35]=C):C=V[35];let U=`materializedViews.${M}.minGranularity`;V[36]!==D||V[37]!==U?(E=(0,n.jsxs)(p.x.Col,{span:1,children:[C,(0,n.jsx)(l.xI,{control:D,name:U,render:eN})]}),V[36]=D,V[37]=U,V[38]=E):E=V[38],V[39]===Symbol.for("react.memo_cache_sentinel")?(N=(0,n.jsxs)(c.E,{size:"xs",fw:500,mb:4,children:["Minimum Date",(0,n.jsx)(m.m,{label:"(Optional) The earliest date and time (in the local timezone) for which the materialized view contains data. If not provided, then HyperDX will assume that the materialized view contains data for all dates for which the source table contains data.",color:"dark",c:"white",multiline:!0,maw:600,children:(0,n.jsx)(z.A,{size:14,className:"cursor-pointer ms-1"})})]}),V[39]=N):N=V[39];let Q=`materializedViews.${M}.minDate`;V[40]!==D||V[41]!==Q?(_=(0,n.jsxs)(p.x.Col,{span:1,children:[N,(0,n.jsx)(l.xI,{control:D,name:Q,render:eE})]}),V[40]=D,V[41]=Q,V[42]=_):_=V[42],V[43]!==y||V[44]!==w||V[45]!==E||V[46]!==_||V[47]!==i?(T=(0,n.jsxs)(p.x,{columns:2,flex:1,children:[i,y,w,E,_]}),V[43]=y,V[44]=w,V[45]=E,V[46]=_,V[47]=i,V[48]=T):T=V[48],V[49]===Symbol.for("react.memo_cache_sentinel")?($=(0,n.jsxs)(c.E,{size:"xs",fw:500,mb:4,children:["Dimension Columns (comma-separated)",(0,n.jsx)(m.m,{label:"Columns which are not pre-aggregated in the materialized view and can be used for filtering and grouping.",color:"dark",c:"white",multiline:!0,maw:600,children:(0,n.jsx)(z.A,{size:14,className:"cursor-pointer ms-1"})})]}),V[49]=$):$=V[49],V[50]!==O||V[51]!==R||V[52]!==Y?(k={databaseName:R,tableName:Y,connectionId:O},V[50]=O,V[51]=R,V[52]=Y,V[53]=k):k=V[53];let J=`materializedViews.${M}.dimensionColumns`;return V[54]!==D||V[55]!==k||V[56]!==J?(I=(0,n.jsxs)(x.a,{children:[$,(0,n.jsx)(ep.Z,{tableConnection:k,control:D,name:J,placeholder:"ServiceName, StatusCode",disableKeywordAutocomplete:!0})]}),V[54]=D,V[55]=k,V[56]=J,V[57]=I):I=V[57],V[58]!==D||V[59]!==M||V[60]!==q?(F=(0,n.jsx)(e_,{control:D,mvIndex:M,setValue:q}),V[58]=D,V[59]=M,V[60]=q,V[61]=F):F=V[61],V[62]===Symbol.for("react.memo_cache_sentinel")?(H=(0,n.jsx)(j.c,{}),V[62]=H):H=V[62],V[63]!==T||V[64]!==I||V[65]!==F?(L=(0,n.jsxs)(d.B,{gap:"sm",children:[T,I,F,H]}),V[63]=T,V[64]=I,V[65]=F,V[66]=L):L=V[66],L}function eE(e){let{field:t}=e;return(0,n.jsx)(C.J,{...t,value:t.value?new Date(t.value):void 0,onChange:e=>t.onChange(e?e.toISOString():null),clearable:!0,highlightToday:!0,placeholder:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss"})}function eN(e){let{field:t}=e;return(0,n.jsx)(y.l,{...t,data:q,placeholder:"Granularity",size:"sm"})}function e_({control:e,setValue:t,mvIndex:a}){let{fields:r,append:o,remove:d,replace:u}=(0,l.jz)({control:e,name:`materializedViews.${a}.aggregatedColumns`}),h=(0,s.useCallback)(()=>{o({sourceColumn:"",aggFn:"avg",mvColumn:""})},[o]),b=(0,l.FH)({control:e,name:"kind"}),j=(0,l.FH)({control:e,name:"connection"}),y=(0,l.FH)({control:e,name:`materializedViews.${a}.tableName`}),S=(0,l.FH)({control:e,name:`materializedViews.${a}.databaseName`}),v=(0,l.FH)({control:e,name:"from.databaseName"}),w=(0,l.FH)({control:e,name:"from.tableName"}),C=(0,s.useRef)(y),E=(0,V.Ge)();return(0,s.useEffect)(()=>{(async()=>{try{if(y!==C.current&&(C.current=y,(b===i.GL.Log||b===i.GL.Trace)&&j&&S&&y&&v&&w)){let e=await K({databaseName:S,tableName:y,connectionId:j},{databaseName:v,tableName:w,connectionId:j},E);e?(t(`materializedViews.${a}`,e),u(e.aggregatedColumns??[]),_.$e.show({color:"green",id:"mv-infer-success",message:"Partially inferred materialized view configuration from view schema."})):_.$e.show({color:"yellow",id:"mv-infer-failure",message:"Unable to infer materialized view configuration."})}}catch(e){console.error(e)}})()},[y,b,j,S,v,w,a,u,t,E]),(0,n.jsxs)(x.a,{children:[(0,n.jsxs)(c.E,{size:"xs",mb:4,children:["Pre-aggregated Columns",(0,n.jsx)(m.m,{label:"Columns which are pre-aggregated by the materialized view",color:"dark",c:"white",multiline:!0,maw:600,children:(0,n.jsx)(z.A,{size:14,className:"cursor-pointer ms-1"})})]}),(0,n.jsx)(p.x,{columns:10,children:r.map((r,s)=>(0,n.jsx)(ez,{setValue:t,control:e,mvIndex:a,colIndex:s,onRemove:()=>d(s)},r.id))}),(0,n.jsx)(f.$,{size:"sm",variant:"secondary",onClick:h,mt:"lg",children:(0,n.jsxs)(g.Y,{children:[(0,n.jsx)($.A,{size:16}),"Add Column"]})})]})}function ez(e){let t,a,s,o,i,c,d,m,u,h,f,j,y,S,v,w=(0,r.c)(48),{control:C,mvIndex:E,colIndex:N,onRemove:_}=e;w[0]!==C?(t={control:C,name:"connection"},w[0]=C,w[1]=t):t=w[1];let z=(0,l.FH)(t);w[2]!==C?(a={control:C,name:"from.databaseName",defaultValue:eb},w[2]=C,w[3]=a):a=w[3];let T=(0,l.FH)(a);w[4]!==C?(s={control:C,name:"from.tableName"},w[4]=C,w[5]=s):s=w[5];let $=(0,l.FH)(s),k=`materializedViews.${E}.databaseName`;w[6]!==C||w[7]!==T||w[8]!==k?(o={control:C,name:k,defaultValue:T},w[6]=C,w[7]=T,w[8]=k,w[9]=o):o=w[9];let I=(0,l.FH)(o),F=`materializedViews.${E}.tableName`;w[10]!==C||w[11]!==F?(i={control:C,name:F},w[10]=C,w[11]=F,w[12]=i):i=w[12];let H=(0,l.FH)(i),L=`materializedViews.${E}.aggregatedColumns.${N}.aggFn`;w[13]!==C||w[14]!==L?(c={control:C,name:L},w[13]=C,w[14]=L,w[15]=c):c=w[15];let V="count"===(0,l.FH)(c),D=`materializedViews.${E}.aggregatedColumns.${N}.aggFn`;w[16]!==C||w[17]!==D?(d=(0,n.jsx)(p.x.Col,{span:2,children:(0,n.jsx)(ex.A,{control:C,name:D,data:ef,size:"sm"})}),w[16]=C,w[17]=D,w[18]=d):d=w[18],w[19]!==N||w[20]!==z||w[21]!==C||w[22]!==V||w[23]!==E||w[24]!==T||w[25]!==$?(m=!V&&(0,n.jsx)(p.x.Col,{span:4,children:(0,n.jsx)(ep.Z,{tableConnection:{databaseName:T,tableName:$,connectionId:z},control:C,name:`materializedViews.${E}.aggregatedColumns.${N}.sourceColumn`,placeholder:"Source Column",disableKeywordAutocomplete:!0})}),w[19]=N,w[20]=z,w[21]=C,w[22]=V,w[23]=E,w[24]=T,w[25]=$,w[26]=m):m=w[26];let M=V?8:4;w[27]!==z||w[28]!==I||w[29]!==H?(u={databaseName:I,tableName:H,connectionId:z},w[27]=z,w[28]=I,w[29]=H,w[30]=u):u=w[30];let Z=`materializedViews.${E}.aggregatedColumns.${N}.mvColumn`;return w[31]!==C||w[32]!==u||w[33]!==Z?(h=(0,n.jsx)(x.a,{flex:1,children:(0,n.jsx)(ep.Z,{tableConnection:u,control:C,name:Z,placeholder:"View Column",disableKeywordAutocomplete:!0})}),w[31]=C,w[32]=u,w[33]=Z,w[34]=h):h=w[34],w[35]===Symbol.for("react.memo_cache_sentinel")?(f=(0,n.jsx)(A.A,{size:16}),w[35]=f):f=w[35],w[36]!==_?(j=(0,n.jsx)(b.M,{size:"sm",onClick:_,children:f}),w[36]=_,w[37]=j):j=w[37],w[38]!==h||w[39]!==j?(y=(0,n.jsxs)(g.Y,{wrap:"nowrap",children:[h,j]}),w[38]=h,w[39]=j,w[40]=y):y=w[40],w[41]!==M||w[42]!==y?(S=(0,n.jsx)(p.x.Col,{span:M,children:y}),w[41]=M,w[42]=y,w[43]=S):S=w[43],w[44]!==d||w[45]!==m||w[46]!==S?(v=(0,n.jsxs)(n.Fragment,{children:[d,m,S]}),w[44]=d,w[45]=m,w[46]=S,w[47]=v):v=w[47],v}function eT(e){let t,a,o,i,c,m,u,h,p,b,y,v,w,C,E,N,_,z,T,A,$,F,H,L,V,D,M,Z,q,O,G,B,R,P,Y,K,W,X,U,Q,J,ee,et=(0,r.c)(129),{control:ea}=e;et[0]!==ea?(t={control:ea,name:"from.databaseName",defaultValue:eb},et[0]=ea,et[1]=t):t=et[1];let en=(0,l.FH)(t);et[2]!==ea?(a={control:ea,name:"from.tableName"},et[2]=ea,et[3]=a):a=et[3];let er=(0,l.FH)(a);et[4]!==ea?(o={control:ea,name:"connection"},et[4]=ea,et[5]=o):o=et[5];let es=(0,l.FH)(o),[el,eo]=(0,s.useState)(!1);et[6]!==es||et[7]!==en||et[8]!==er?(i={databaseName:en,tableName:er,connectionId:es},et[6]=es,et[7]=en,et[8]=er,et[9]=i):i=et[9],et[10]!==ea||et[11]!==i?(c=(0,n.jsx)(ey,{label:"Timestamp Column",helpText:"DateTime column or expression that is part of your table's primary key.",children:(0,n.jsx)(ep.Z,{tableConnection:i,control:ea,name:"timestampValueExpression",disableKeywordAutocomplete:!0})}),et[10]=ea,et[11]=i,et[12]=c):c=et[12],et[13]!==es||et[14]!==en||et[15]!==er?(m={databaseName:en,tableName:er,connectionId:es},et[13]=es,et[14]=en,et[15]=er,et[16]=m):m=et[16],et[17]!==ea||et[18]!==m?(u=(0,n.jsx)(ey,{label:"Default Select",helpText:"Default columns selected in search results (this can be customized per search later)",children:(0,n.jsx)(ep.Z,{tableConnection:m,control:ea,name:"defaultTableSelectExpression",placeholder:"Timestamp, Body"})}),et[17]=ea,et[18]=m,et[19]=u):u=et[19],et[20]!==el?(h=!el&&(0,n.jsx)(S.M,{underline:"always",onClick:()=>eo(!0),size:"xs",children:(0,n.jsxs)(g.Y,{gap:"xs",children:[(0,n.jsx)(k.A,{size:14}),"Configure Optional Fields"]})}),et[20]=el,et[21]=h):h=et[21],et[22]!==el?(p=el&&(0,n.jsx)(f.$,{onClick:()=>eo(!1),size:"xs",variant:"subtle",children:"Hide Optional Fields"}),et[22]=el,et[23]=p):p=et[23],et[24]!==h||et[25]!==p?(b=(0,n.jsxs)(x.a,{children:[h,p]}),et[24]=h,et[25]=p,et[26]=b):b=et[26],et[27]!==c||et[28]!==u||et[29]!==b?(y=(0,n.jsxs)(d.B,{gap:"sm",children:[c,u,b]}),et[27]=c,et[28]=u,et[29]=b,et[30]=y):y=et[30];let ei=el?"flex":"none";return et[31]!==ei?(v={display:ei},et[31]=ei,et[32]=v):v=et[32],et[33]===Symbol.for("react.memo_cache_sentinel")?(w=(0,n.jsx)(j.c,{}),et[33]=w):w=et[33],et[34]!==es||et[35]!==en||et[36]!==er?(C={databaseName:en,tableName:er,connectionId:es},et[34]=es,et[35]=en,et[36]=er,et[37]=C):C=et[37],et[38]!==ea||et[39]!==C?(E=(0,n.jsx)(ey,{label:"Service Name Expression",children:(0,n.jsx)(ep.Z,{tableConnection:C,control:ea,name:"serviceNameExpression",placeholder:"ServiceName"})}),et[38]=ea,et[39]=C,et[40]=E):E=et[40],et[41]!==es||et[42]!==en||et[43]!==er?(N={databaseName:en,tableName:er,connectionId:es},et[41]=es,et[42]=en,et[43]=er,et[44]=N):N=et[44],et[45]!==ea||et[46]!==N?(_=(0,n.jsx)(ey,{label:"Log Level Expression",children:(0,n.jsx)(ep.Z,{tableConnection:N,control:ea,name:"severityTextExpression",placeholder:"SeverityText"})}),et[45]=ea,et[46]=N,et[47]=_):_=et[47],et[48]!==es||et[49]!==en||et[50]!==er?(z={databaseName:en,tableName:er,connectionId:es},et[48]=es,et[49]=en,et[50]=er,et[51]=z):z=et[51],et[52]!==ea||et[53]!==z?(T=(0,n.jsx)(ey,{label:"Body Expression",children:(0,n.jsx)(ep.Z,{tableConnection:z,control:ea,name:"bodyExpression",placeholder:"Body"})}),et[52]=ea,et[53]=z,et[54]=T):T=et[54],et[55]!==es||et[56]!==en||et[57]!==er?(A={databaseName:en,tableName:er,connectionId:es},et[55]=es,et[56]=en,et[57]=er,et[58]=A):A=et[58],et[59]!==ea||et[60]!==A?($=(0,n.jsx)(ey,{label:"Log Attributes Expression",children:(0,n.jsx)(ep.Z,{tableConnection:A,control:ea,name:"eventAttributesExpression",placeholder:"LogAttributes"})}),et[59]=ea,et[60]=A,et[61]=$):$=et[61],et[62]!==es||et[63]!==en||et[64]!==er?(F={databaseName:en,tableName:er,connectionId:es},et[62]=es,et[63]=en,et[64]=er,et[65]=F):F=et[65],et[66]!==ea||et[67]!==F?(H=(0,n.jsx)(ey,{label:"Resource Attributes Expression",children:(0,n.jsx)(ep.Z,{tableConnection:F,control:ea,name:"resourceAttributesExpression",placeholder:"ResourceAttributes"})}),et[66]=ea,et[67]=F,et[68]=H):H=et[68],et[69]!==es||et[70]!==en||et[71]!==er?(L={databaseName:en,tableName:er,connectionId:es},et[69]=es,et[70]=en,et[71]=er,et[72]=L):L=et[72],et[73]!==ea||et[74]!==L?(V=(0,n.jsx)(ey,{label:"Displayed Timestamp Column",helpText:"This DateTime column is used to display and order search results.",children:(0,n.jsx)(ep.Z,{tableConnection:L,control:ea,name:"displayedTimestampValueExpression",disableKeywordAutocomplete:!0})}),et[73]=ea,et[74]=L,et[75]=V):V=et[75],et[76]===Symbol.for("react.memo_cache_sentinel")?(D=(0,n.jsx)(j.c,{}),et[76]=D):D=et[76],et[77]!==ea?(M=(0,n.jsx)(ey,{label:"Correlated Metric Source",helpText:"HyperDX Source for metrics associated with logs. Optional",children:(0,n.jsx)(I.W,{control:ea,name:"metricSourceId"})}),et[77]=ea,et[78]=M):M=et[78],et[79]!==ea?(Z=(0,n.jsx)(ey,{label:"Correlated Trace Source",helpText:"HyperDX Source for traces associated with logs. Optional",children:(0,n.jsx)(I.W,{control:ea,name:"traceSourceId"})}),et[79]=ea,et[80]=Z):Z=et[80],et[81]!==es||et[82]!==en||et[83]!==er?(q={databaseName:en,tableName:er,connectionId:es},et[81]=es,et[82]=en,et[83]=er,et[84]=q):q=et[84],et[85]!==ea||et[86]!==q?(O=(0,n.jsx)(ey,{label:"Trace Id Expression",children:(0,n.jsx)(ep.Z,{tableConnection:q,control:ea,name:"traceIdExpression",placeholder:"TraceId"})}),et[85]=ea,et[86]=q,et[87]=O):O=et[87],et[88]!==es||et[89]!==en||et[90]!==er?(G={databaseName:en,tableName:er,connectionId:es},et[88]=es,et[89]=en,et[90]=er,et[91]=G):G=et[91],et[92]!==ea||et[93]!==G?(B=(0,n.jsx)(ey,{label:"Span Id Expression",children:(0,n.jsx)(ep.Z,{tableConnection:G,control:ea,name:"spanIdExpression",placeholder:"SpanId"})}),et[92]=ea,et[93]=G,et[94]=B):B=et[94],et[95]===Symbol.for("react.memo_cache_sentinel")?(R=(0,n.jsx)(j.c,{}),et[95]=R):R=et[95],et[96]!==es||et[97]!==en||et[98]!==er?(P={databaseName:en,tableName:er,connectionId:es},et[96]=es,et[97]=en,et[98]=er,et[99]=P):P=et[99],et[100]!==ea||et[101]!==P?(Y=(0,n.jsx)(ey,{label:"Implicit Column Expression",helpText:"Column used for full text search if no property is specified in a Lucene-based search. Typically the message body of a log.",children:(0,n.jsx)(ep.Z,{tableConnection:P,control:ea,name:"implicitColumnExpression",placeholder:"Body"})}),et[100]=ea,et[101]=P,et[102]=Y):Y=et[102],et[103]===Symbol.for("react.memo_cache_sentinel")?(K=(0,n.jsx)(j.c,{}),et[103]=K):K=et[103],et[104]!==e?(W=(0,n.jsx)(ev,{...e,name:"highlightedRowAttributeExpressions",label:"Highlighted Attributes",helpText:"Expressions defining row-level attributes which are displayed in the row side panel for the selected row."}),X=(0,n.jsx)(ev,{...e,name:"highlightedTraceAttributeExpressions",label:"Highlighted Trace Attributes",helpText:"Expressions defining trace-level attributes which are displayed in the trace view for the selected trace."}),et[104]=e,et[105]=W,et[106]=X):(W=et[105],X=et[106]),et[107]===Symbol.for("react.memo_cache_sentinel")?(U=(0,n.jsx)(j.c,{}),et[107]=U):U=et[107],et[108]!==e?(Q=(0,n.jsx)(ew,{...e}),et[108]=e,et[109]=Q):Q=et[109],et[110]!==v||et[111]!==E||et[112]!==_||et[113]!==T||et[114]!==$||et[115]!==H||et[116]!==V||et[117]!==M||et[118]!==Z||et[119]!==O||et[120]!==B||et[121]!==Y||et[122]!==W||et[123]!==X||et[124]!==Q?(J=(0,n.jsxs)(d.B,{gap:"sm",style:v,children:[w,E,_,T,$,H,V,D,M,Z,O,B,R,Y,K,W,X,U,Q]}),et[110]=v,et[111]=E,et[112]=_,et[113]=T,et[114]=$,et[115]=H,et[116]=V,et[117]=M,et[118]=Z,et[119]=O,et[120]=B,et[121]=Y,et[122]=W,et[123]=X,et[124]=Q,et[125]=J):J=et[125],et[126]!==y||et[127]!==J?(ee=(0,n.jsxs)(n.Fragment,{children:[y,J]}),et[126]=y,et[127]=J,et[128]=ee):ee=et[128],ee}function eA(e){let t,a,s,o,i,c,m,u,h,p,b,f,g,y,S,v,w,C,E,N,_,z,T,A,$,k,F,H,L,V,D,M,Z,q,O,G,B,R,P,Y,K,W,X,U,Q,J,ee,et=(0,r.c)(159),{control:ea}=e;et[0]!==ea?(t={control:ea,name:"from.databaseName",defaultValue:eb},et[0]=ea,et[1]=t):t=et[1];let en=(0,l.FH)(t);et[2]!==ea?(a={control:ea,name:"from.tableName"},et[2]=ea,et[3]=a):a=et[3];let er=(0,l.FH)(a);et[4]!==ea?(s={control:ea,name:"connection"},et[4]=ea,et[5]=s):s=et[5];let es=(0,l.FH)(s);return et[6]!==es||et[7]!==en||et[8]!==er?(o={databaseName:en,tableName:er,connectionId:es},et[6]=es,et[7]=en,et[8]=er,et[9]=o):o=et[9],et[10]!==ea||et[11]!==o?(i=(0,n.jsx)(ey,{label:"Timestamp Column",helpText:"DateTime column or expression defines the start of the span",children:(0,n.jsx)(ep.Z,{tableConnection:o,control:ea,name:"timestampValueExpression",placeholder:"Timestamp",disableKeywordAutocomplete:!0})}),et[10]=ea,et[11]=o,et[12]=i):i=et[12],et[13]!==es||et[14]!==en||et[15]!==er?(c={databaseName:en,tableName:er,connectionId:es},et[13]=es,et[14]=en,et[15]=er,et[16]=c):c=et[16],et[17]!==ea||et[18]!==c?(m=(0,n.jsx)(ey,{label:"Default Select",helpText:"Default columns selected in search results (this can be customized per search later)",children:(0,n.jsx)(ep.Z,{tableConnection:c,control:ea,name:"defaultTableSelectExpression",placeholder:"Timestamp, ServiceName, StatusCode, Duration, SpanName"})}),et[17]=ea,et[18]=c,et[19]=m):m=et[19],et[20]===Symbol.for("react.memo_cache_sentinel")?(u=(0,n.jsx)(j.c,{}),et[20]=u):u=et[20],et[21]!==es||et[22]!==en||et[23]!==er?(h={databaseName:en,tableName:er,connectionId:es},et[21]=es,et[22]=en,et[23]=er,et[24]=h):h=et[24],et[25]!==ea||et[26]!==h?(p=(0,n.jsx)(ey,{label:"Duration Expression",children:(0,n.jsx)(ep.Z,{tableConnection:h,control:ea,name:"durationExpression",placeholder:"Duration Column"})}),et[25]=ea,et[26]=h,et[27]=p):p=et[27],et[28]!==ea?(b=(0,n.jsx)(ey,{label:"Duration Precision",children:(0,n.jsx)(x.a,{mx:"xl",children:(0,n.jsx)(l.xI,{control:ea,name:"durationPrecision",render:e$})})}),et[28]=ea,et[29]=b):b=et[29],et[30]!==es||et[31]!==en||et[32]!==er?(f={databaseName:en,tableName:er,connectionId:es},et[30]=es,et[31]=en,et[32]=er,et[33]=f):f=et[33],et[34]!==ea||et[35]!==f?(g=(0,n.jsx)(ey,{label:"Trace Id Expression",children:(0,n.jsx)(ep.Z,{tableConnection:f,control:ea,name:"traceIdExpression",placeholder:"TraceId"})}),et[34]=ea,et[35]=f,et[36]=g):g=et[36],et[37]!==es||et[38]!==en||et[39]!==er?(y={databaseName:en,tableName:er,connectionId:es},et[37]=es,et[38]=en,et[39]=er,et[40]=y):y=et[40],et[41]!==ea||et[42]!==y?(S=(0,n.jsx)(ey,{label:"Span Id Expression",children:(0,n.jsx)(ep.Z,{tableConnection:y,control:ea,name:"spanIdExpression",placeholder:"SpanId"})}),et[41]=ea,et[42]=y,et[43]=S):S=et[43],et[44]!==es||et[45]!==en||et[46]!==er?(v={databaseName:en,tableName:er,connectionId:es},et[44]=es,et[45]=en,et[46]=er,et[47]=v):v=et[47],et[48]!==ea||et[49]!==v?(w=(0,n.jsx)(ey,{label:"Parent Span Id Expression",children:(0,n.jsx)(ep.Z,{tableConnection:v,control:ea,name:"parentSpanIdExpression",placeholder:"ParentSpanId"})}),et[48]=ea,et[49]=v,et[50]=w):w=et[50],et[51]!==es||et[52]!==en||et[53]!==er?(C={databaseName:en,tableName:er,connectionId:es},et[51]=es,et[52]=en,et[53]=er,et[54]=C):C=et[54],et[55]!==ea||et[56]!==C?(E=(0,n.jsx)(ey,{label:"Span Name Expression",children:(0,n.jsx)(ep.Z,{tableConnection:C,control:ea,name:"spanNameExpression",placeholder:"SpanName"})}),et[55]=ea,et[56]=C,et[57]=E):E=et[57],et[58]!==es||et[59]!==en||et[60]!==er?(N={databaseName:en,tableName:er,connectionId:es},et[58]=es,et[59]=en,et[60]=er,et[61]=N):N=et[61],et[62]!==ea||et[63]!==N?(_=(0,n.jsx)(ey,{label:"Span Kind Expression",children:(0,n.jsx)(ep.Z,{tableConnection:N,control:ea,name:"spanKindExpression",placeholder:"SpanKind"})}),et[62]=ea,et[63]=N,et[64]=_):_=et[64],et[65]===Symbol.for("react.memo_cache_sentinel")?(z=(0,n.jsx)(j.c,{}),et[65]=z):z=et[65],et[66]!==ea?(T=(0,n.jsx)(ey,{label:"Correlated Log Source",helpText:"HyperDX Source for logs associated with traces. Optional",children:(0,n.jsx)(I.W,{control:ea,name:"logSourceId"})}),et[66]=ea,et[67]=T):T=et[67],et[68]!==ea?(A=(0,n.jsx)(ey,{label:"Correlated Session Source",helpText:"HyperDX Source for sessions associated with traces. Optional",children:(0,n.jsx)(I.W,{control:ea,name:"sessionSourceId"})}),et[68]=ea,et[69]=A):A=et[69],et[70]!==ea?($=(0,n.jsx)(ey,{label:"Correlated Metric Source",helpText:"HyperDX Source for metrics associated with traces. Optional",children:(0,n.jsx)(I.W,{control:ea,name:"metricSourceId"})}),et[70]=ea,et[71]=$):$=et[71],et[72]!==es||et[73]!==en||et[74]!==er?(k={databaseName:en,tableName:er,connectionId:es},et[72]=es,et[73]=en,et[74]=er,et[75]=k):k=et[75],et[76]!==ea||et[77]!==k?(F=(0,n.jsx)(ey,{label:"Status Code Expression",children:(0,n.jsx)(ep.Z,{tableConnection:k,control:ea,name:"statusCodeExpression",placeholder:"StatusCode"})}),et[76]=ea,et[77]=k,et[78]=F):F=et[78],et[79]!==es||et[80]!==en||et[81]!==er?(H={databaseName:en,tableName:er,connectionId:es},et[79]=es,et[80]=en,et[81]=er,et[82]=H):H=et[82],et[83]!==ea||et[84]!==H?(L=(0,n.jsx)(ey,{label:"Status Message Expression",children:(0,n.jsx)(ep.Z,{tableConnection:H,control:ea,name:"statusMessageExpression",placeholder:"StatusMessage"})}),et[83]=ea,et[84]=H,et[85]=L):L=et[85],et[86]!==es||et[87]!==en||et[88]!==er?(V={databaseName:en,tableName:er,connectionId:es},et[86]=es,et[87]=en,et[88]=er,et[89]=V):V=et[89],et[90]!==ea||et[91]!==V?(D=(0,n.jsx)(ey,{label:"Service Name Expression",children:(0,n.jsx)(ep.Z,{tableConnection:V,control:ea,name:"serviceNameExpression",placeholder:"ServiceName"})}),et[90]=ea,et[91]=V,et[92]=D):D=et[92],et[93]!==es||et[94]!==en||et[95]!==er?(M={databaseName:en,tableName:er,connectionId:es},et[93]=es,et[94]=en,et[95]=er,et[96]=M):M=et[96],et[97]!==ea||et[98]!==M?(Z=(0,n.jsx)(ey,{label:"Resource Attributes Expression",children:(0,n.jsx)(ep.Z,{tableConnection:M,control:ea,name:"resourceAttributesExpression",placeholder:"ResourceAttributes"})}),et[97]=ea,et[98]=M,et[99]=Z):Z=et[99],et[100]!==es||et[101]!==en||et[102]!==er?(q={databaseName:en,tableName:er,connectionId:es},et[100]=es,et[101]=en,et[102]=er,et[103]=q):q=et[103],et[104]!==ea||et[105]!==q?(O=(0,n.jsx)(ey,{label:"Event Attributes Expression",children:(0,n.jsx)(ep.Z,{tableConnection:q,control:ea,name:"eventAttributesExpression",placeholder:"SpanAttributes"})}),et[104]=ea,et[105]=q,et[106]=O):O=et[106],et[107]!==es||et[108]!==en||et[109]!==er?(G={databaseName:en,tableName:er,connectionId:es},et[107]=es,et[108]=en,et[109]=er,et[110]=G):G=et[110],et[111]!==ea||et[112]!==G?(B=(0,n.jsx)(ey,{label:"Span Events Expression",helpText:"Expression to extract span events. Used to capture events associated with spans. Expected to be Nested ( Timestamp DateTime64(9), Name LowCardinality(String), Attributes Map(LowCardinality(String), String)",children:(0,n.jsx)(ep.Z,{tableConnection:G,control:ea,name:"spanEventsValueExpression",placeholder:"Events"})}),et[111]=ea,et[112]=G,et[113]=B):B=et[113],et[114]!==es||et[115]!==en||et[116]!==er?(R={databaseName:en,tableName:er,connectionId:es},et[114]=es,et[115]=en,et[116]=er,et[117]=R):R=et[117],et[118]!==ea||et[119]!==R?(P=(0,n.jsx)(ey,{label:"Implicit Column Expression",helpText:"Column used for full text search if no property is specified in a Lucene-based search. Typically the message body of a log.",children:(0,n.jsx)(ep.Z,{tableConnection:R,control:ea,name:"implicitColumnExpression",placeholder:"SpanName"})}),et[118]=ea,et[119]=R,et[120]=P):P=et[120],et[121]!==es||et[122]!==en||et[123]!==er?(Y={databaseName:en,tableName:er,connectionId:es},et[121]=es,et[122]=en,et[123]=er,et[124]=Y):Y=et[124],et[125]!==ea||et[126]!==Y?(K=(0,n.jsx)(ey,{label:"Displayed Timestamp Column",helpText:"This DateTime column is used to display and order search results.",children:(0,n.jsx)(ep.Z,{tableConnection:Y,control:ea,name:"displayedTimestampValueExpression",disableKeywordAutocomplete:!0})}),et[125]=ea,et[126]=Y,et[127]=K):K=et[127],et[128]===Symbol.for("react.memo_cache_sentinel")?(W=(0,n.jsx)(j.c,{}),et[128]=W):W=et[128],et[129]!==e?(X=(0,n.jsx)(ev,{...e,name:"highlightedRowAttributeExpressions",label:"Highlighted Attributes",helpText:"Expressions defining row-level attributes which are displayed in the row side panel for the selected row"}),U=(0,n.jsx)(ev,{...e,name:"highlightedTraceAttributeExpressions",label:"Highlighted Trace Attributes",helpText:"Expressions defining trace-level attributes which are displayed in the trace view for the selected trace."}),et[129]=e,et[130]=X,et[131]=U):(X=et[130],U=et[131]),et[132]===Symbol.for("react.memo_cache_sentinel")?(Q=(0,n.jsx)(j.c,{}),et[132]=Q):Q=et[132],et[133]!==e?(J=(0,n.jsx)(ew,{...e}),et[133]=e,et[134]=J):J=et[134],et[135]!==b||et[136]!==g||et[137]!==S||et[138]!==w||et[139]!==E||et[140]!==_||et[141]!==T||et[142]!==A||et[143]!==$||et[144]!==F||et[145]!==L||et[146]!==D||et[147]!==Z||et[148]!==O||et[149]!==B||et[150]!==P||et[151]!==i||et[152]!==K||et[153]!==X||et[154]!==U||et[155]!==J||et[156]!==m||et[157]!==p?(ee=(0,n.jsxs)(d.B,{gap:"sm",children:[i,m,u,p,b,g,S,w,E,_,z,T,A,$,F,L,D,Z,O,B,P,K,W,X,U,Q,J]}),et[135]=b,et[136]=g,et[137]=S,et[138]=w,et[139]=E,et[140]=_,et[141]=T,et[142]=A,et[143]=$,et[144]=F,et[145]=L,et[146]=D,et[147]=Z,et[148]=O,et[149]=B,et[150]=P,et[151]=i,et[152]=K,et[153]=X,et[154]=U,et[155]=J,et[156]=m,et[157]=p,et[158]=ee):ee=et[158],ee}function e$(e){let{field:t}=e,{onChange:a,value:r}=t;return(0,n.jsx)("div",{style:{width:"90%",marginBottom:8},children:(0,n.jsx)(v.A,{color:"green",defaultValue:0,min:0,max:9,marks:[{value:0,label:"Seconds"},{value:3,label:"Millisecond"},{value:6,label:"Microsecond"},{value:9,label:"Nanosecond"}],value:r,onChange:a})})}function ek({control:e}){let t=(0,l.FH)({control:e,name:"from.databaseName",defaultValue:eb}),a=(0,l.FH)({control:e,name:"connection"}),r=(0,l.FH)({control:e,name:"from.tableName"}),o=(0,s.useRef)(r),i=(0,V.Ge)();return(0,s.useEffect)(()=>{(async()=>{try{r&&r!==o.current&&(o.current=r,await (0,D.Al)({databaseName:t,tableName:r,connectionId:a,metadata:i})||_.$e.show({color:"red",message:`${r} is not a valid Sessions schema.`}))}catch(e){console.error(e),_.$e.show({color:"red",message:e.message})}})()},[r,t,a,i]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(d.B,{gap:"sm",children:[(0,n.jsx)(ey,{label:"Correlated Trace Source",helpText:"HyperDX Source for traces associated with sessions. Required",children:(0,n.jsx)(I.W,{control:e,name:"traceSourceId"})}),(0,n.jsx)(ey,{label:"Timestamp Column",helpText:"DateTime column or expression that is part of your table's primary key.",children:(0,n.jsx)(ep.Z,{tableConnection:{databaseName:t,tableName:r,connectionId:a},control:e,name:"timestampValueExpression",disableKeywordAutocomplete:!0})})]})})}function eI({control:e,setValue:t}){let a=(0,l.FH)({control:e,name:"from.databaseName",defaultValue:eb}),r=(0,l.FH)({control:e,name:"connection"}),o=(0,l.FH)({control:e,name:"metricTables"}),c=(0,s.useRef)(o),m=(0,V.Ge)();return(0,s.useEffect)(()=>{for(let[e,a]of Object.entries(eg))t(e,a)},[t]),(0,s.useEffect)(()=>{(async()=>{try{if(o&&c.current)for(let e of Object.values(i.SX)){let t=o[e],n=c.current[e];t!==n&&(await (0,D.fS)({databaseName:a,tableName:t,connectionId:r,metricType:e,metadata:m})||_.$e.show({color:"red",message:`${t} is not a valid OTEL ${e} schema.`}))}c.current=o}catch(e){console.error(e),_.$e.show({color:"red",message:e.message})}})()},[o,a,r,m]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(d.B,{gap:"sm",children:[Object.values(i.SX).map(t=>(0,n.jsx)(ey,{label:`${t} Table`,helpText:t===i.SX.ExponentialHistogram||t===i.SX.Summary?`Table containing ${t.toLowerCase()} metrics data. Note: not yet fully supported by HyperDX`:`Table containing ${t.toLowerCase()} metrics data`,children:(0,n.jsx)(el,{connectionId:r,database:a,control:e,name:`metricTables.${t.toLowerCase()}`})},t.toLowerCase())),(0,n.jsx)(ey,{label:"Correlated Log Source",helpText:"HyperDX Source for logs associated with metrics. Optional",children:(0,n.jsx)(I.W,{control:e,name:"logSourceId"})})]})})}function eF(e){let t=(0,r.c)(12),{control:a,setValue:s,kind:l}=e;switch(l){case i.GL.Log:{let e;return t[0]!==a||t[1]!==s?(e=(0,n.jsx)(eT,{control:a,setValue:s}),t[0]=a,t[1]=s,t[2]=e):e=t[2],e}case i.GL.Trace:{let e;return t[3]!==a||t[4]!==s?(e=(0,n.jsx)(eA,{control:a,setValue:s}),t[3]=a,t[4]=s,t[5]=e):e=t[5],e}case i.GL.Session:{let e;return t[6]!==a||t[7]!==s?(e=(0,n.jsx)(ek,{control:a,setValue:s}),t[6]=a,t[7]=s,t[8]=e):e=t[8],e}case i.GL.Metric:{let e;return t[9]!==a||t[10]!==s?(e=(0,n.jsx)(eI,{control:a,setValue:s}),t[9]=a,t[10]=s,t[11]=e):e=t[11],e}}}function eH({sourceId:e,onSave:t,onCreate:a,isNew:r=!1,defaultName:o="",onCancel:m}){let{data:u}=(0,D.Fo)({id:e}),{data:x}=(0,H.ZY)(),{control:j,setValue:y,handleSubmit:v,resetField:C,setError:E,clearErrors:N}=(0,l.mN)({defaultValues:{kind:i.GL.Log,name:o,connection:x?.[0]?.id,from:{databaseName:"default",tableName:""},querySettings:u?.querySettings},values:u,resetOptions:{keepDirtyValues:!0,keepErrors:!0}}),z=(0,l.FH)({control:j,name:"connection",defaultValue:u?.connection}),T=(0,l.FH)({control:j,name:"from.databaseName",defaultValue:u?.from?.databaseName||eb}),k=(0,l.FH)({control:j,name:"from.tableName",defaultValue:u?.from?.tableName}),I=(0,l.FH)({control:j,name:"kind",defaultValue:u?.kind||i.GL.Log}),L=(0,s.useRef)(k),M=(0,V.Ge)();(0,s.useEffect)(()=>{(async()=>{try{if(k!==L.current&&(L.current=k,null!=z&&null!=T&&(I===i.GL.Metric||null!=k))){let e=await (0,D.Ys)({databaseName:T,tableName:I!==i.GL.Metric?k:"",connectionId:z,metadata:M});Object.keys(e).length>0&&_.$e.show({color:"green",message:"Automatically inferred source configuration from table schema."}),Object.entries(e).forEach(([e,t])=>{C(e,{keepDirty:!0,defaultValue:t})})}}catch(e){console.error(e)}})()},[k,z,T,I,C,M]),(0,s.useEffect)(()=>{C("connection",{defaultValue:x?.[0]?.id})},[x,C]);let Z=(0,l.FH)({control:j,name:"kind",defaultValue:u?.kind||i.GL.Log}),q=(0,D.nd)(),O=(0,D.sr)(),G=(0,D.YI)(),{data:B}=(0,D.oE)(),R=(0,l.FH)({control:j,name:"id"}),P=(0,l.FH)({control:j,name:"logSourceId"}),Y=(0,l.FH)({control:j,name:"traceSourceId"}),K=(0,l.FH)({control:j,name:"metricSourceId"}),U=(0,l.FH)({control:j,name:"traceSourceId"}),Q=(0,s.useRef)(P),J=(0,s.useRef)(Y),ee=(0,s.useRef)(K),ea=(0,s.useRef)(U);(0,s.useEffect)(()=>{(async()=>{if(!R||!B||!Z)return;let e=ej[Z];if(!e)return;let t=[];for(let{name:a,value:n}of(P!==Q.current&&(Q.current=P,t.push({name:"logSourceId",value:P??void 0})),Y!==J.current&&(J.current=Y,t.push({name:"traceSourceId",value:Y??void 0})),K!==ee.current&&(ee.current=K,t.push({name:"metricSourceId",value:K??void 0})),U!==ea.current&&Z===i.GL.Session&&(ea.current=U,t.push({name:"traceSourceId",value:U??void 0})),t))if(a in e)for(let{targetKind:t,targetField:r}of e[a]){let e=B.find(e=>e.kind===t&&e[r]===R);if(e&&e.id!==n&&await O.mutateAsync({source:{...e,[r]:void 0}}),n){let e=B.find(e=>e.id===n);e&&e.kind===t&&!e[r]&&await O.mutateAsync({source:{...e,[r]:R}})}}})()},[P,Y,K,U,Z,R,B,O]);let en=(0,i.z1)({id:!0}),er=(0,s.useCallback)(({errors:e},t)=>{let a=[];for(let n of(console.debug(`[${t}] SourceForm validation error`,JSON.stringify(e)),e)){let e=n.path.join(".");E(e,{...n});let t="Required"===n.message?`${e}: ${n.message}`:n.message;a.push(t)}_.$e.show({color:"red",message:(0,n.jsxs)(d.B,{children:[(0,n.jsx)(c.E,{size:"sm",children:(0,n.jsx)("b",{children:"Failed to create source"})}),a.map((e,t)=>(0,n.jsxs)(c.E,{size:"sm",children:[" ",e]},t))]})})},[E]),es=(0,s.useCallback)(()=>{N(),v(async e=>{let t=en.safeParse(e);t.error?er(t.error,"create"):q.mutate({source:e},{onSuccess:async e=>{let t=ej[e.kind];if(t&&B)for(let[a,n]of Object.entries(t)){let t=e[a];if(t)for(let{targetKind:a,targetField:r}of n){let n=B.find(e=>e.id===t);n&&n.kind===a&&!n[r]&&await O.mutateAsync({source:{...n,[r]:e.id}})}}a?.(e),_.$e.show({color:"green",message:"Source created"})},onError:e=>{_.$e.show({color:"red",message:`Failed to create source - ${e.message}`})}})})()},[N,er,en,v,q,a,B,O]),eo=(0,s.useCallback)(()=>{N(),v(e=>{let a=en.safeParse(e);a.error?er(a.error,"save"):O.mutate({source:e},{onSuccess:()=>{t?.(),_.$e.show({color:"green",message:"Source updated"})},onError:()=>{_.$e.show({color:"red",message:"Failed to update source"})}})})()},[v,O,t,N,er,en]),ei=(0,l.FH)({control:j,name:"from.databaseName",defaultValue:u?.from?.databaseName||eb}),ec=(0,l.FH)({control:j,name:"connection",defaultValue:u?.connection}),{fields:ed,append:em,remove:eu}=(0,l.jz)({control:j,name:"querySettings"});return(0,n.jsxs)("div",{style:{},children:[(0,n.jsxs)(d.B,{gap:"md",mb:"md",children:[(0,n.jsx)(c.E,{mb:"lg",children:"Source Settings"}),(0,n.jsx)(ey,{label:"Name",children:(0,n.jsx)(eh.t4,{control:j,name:"name",rules:{required:"Name is required"}})}),(0,n.jsx)(ey,{label:"Source Data Type",children:(0,n.jsx)(l.xI,{control:j,name:"kind",render:({field:{onChange:e,value:t}})=>(0,n.jsx)(w.s.Group,{value:t,onChange:t=>e(t),withAsterisk:!0,children:(0,n.jsxs)(g.Y,{children:[(0,n.jsx)(w.s,{value:i.GL.Log,label:"Log"}),(0,n.jsx)(w.s,{value:i.GL.Trace,label:"Trace"}),F.Fm&&(0,n.jsx)(w.s,{value:i.GL.Metric,label:"OTEL Metrics"}),F.vN&&(0,n.jsx)(w.s,{value:i.GL.Session,label:"Session"})]})})})}),(0,n.jsx)(ey,{label:"Server Connection",children:(0,n.jsx)(X.r,{control:j,name:"connection"})}),(0,n.jsx)(ey,{label:"Database",children:(0,n.jsx)(et,{control:j,name:"from.databaseName",connectionId:ec})}),Z!==i.GL.Metric&&(0,n.jsx)(ey,{label:"Table",children:(0,n.jsx)(el,{database:ei,control:j,name:"from.tableName",connectionId:ec,rules:{required:"Table is required"}})}),(0,n.jsxs)(ey,{label:(0,n.jsx)(S.M,{href:"https://clickhouse.com/docs/operations/settings/settings",size:"sm",target:"_blank",children:"Query Settings"}),helpText:"Query-level Session Settings that will be added to each query for this source.",children:[(0,n.jsx)(p.x,{columns:11,children:ed.map((e,t)=>(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)(p.x.Col,{span:5,pe:0,children:(0,n.jsx)(eh.t4,{placeholder:"Setting",control:j,name:`querySettings.${t}.setting`})}),(0,n.jsx)(p.x.Col,{span:5,pe:0,children:(0,n.jsx)(eh.t4,{placeholder:"Value",control:j,name:`querySettings.${t}.value`})}),(0,n.jsx)(p.x.Col,{span:1,ps:0,children:(0,n.jsx)(h.s,{align:"center",justify:"center",gap:"sm",h:"100%",children:(0,n.jsx)(b.M,{variant:"subtle",color:"gray",title:"Remove setting",onClick:()=>eu(t),children:(0,n.jsx)(A.A,{size:16})})})})]},e.id))}),(0,n.jsxs)(f.$,{variant:"secondary",size:"sm",color:"gray",mt:"md",disabled:ed.length>=10,onClick:()=>{ed.length<10&&em({setting:"",value:""})},children:[(0,n.jsx)($.A,{size:14,className:"me-2"}),"Add Setting"]})]})]}),(0,n.jsx)(eF,{control:j,setValue:y,kind:Z}),(0,n.jsxs)(g.Y,{justify:"flex-end",mt:"lg",children:[m&&(0,n.jsx)(f.$,{variant:"secondary",onClick:m,size:"xs",children:"Cancel"}),r?(0,n.jsx)(f.$,{variant:"primary",onClick:es,size:"xs",loading:q.isPending,children:"Save New Source"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(W.A,{onDelete:()=>G.mutate({id:e??""})}),(0,n.jsx)(f.$,{variant:"primary",onClick:eo,size:"xs",loading:q.isPending,children:"Save Source"})]})]})]})}},43567:(e,t,a)=>{"use strict";a.d(t,{B:()=>_});var n,r=a(6029),s=a(75155),l=a(55729),o=a(1909),i=a(88459),c=a(43517),d=a(60481),m=a(25062),u=a(78253),h=a(23935),x=a(3635),p=a(63085),b=a(34834),f=a(60665),g=a(95316),j=a(97702),y=a(6876),S=a(71781),v=a(98142),w=a(93108),C=a(92917),E=a(24207),N=((n=N||{}).Loading="loading",n.Valid="valid",n.Invalid="invalid",n);function _(e){let t,a,n,N,_,A,$,k,I,F,H,L,V,D,M,Z,q,O,G,B,R,P,Y,K,W,X,U,Q,J,ee,et,ea,en,er,es=(0,s.c)(98),{connection:el,isNew:eo,onSave:ei,onClose:ec,showCancelButton:ed,showDeleteButton:em}=e,eu=void 0!==ed&&ed,eh=void 0!==em&&em;es[0]!==el.host||es[1]!==el.hyperdxSettingPrefix||es[2]!==el.id||es[3]!==el.name||es[4]!==el.password||es[5]!==el.username?(t={defaultValues:{id:el.id,name:el.name,host:el.host,username:el.username,password:el.password,hyperdxSettingPrefix:el.hyperdxSettingPrefix}},es[0]=el.host,es[1]=el.hyperdxSettingPrefix,es[2]=el.id,es[3]=el.name,es[4]=el.password,es[5]=el.username,es[6]=t):t=es[6];let{control:ex,handleSubmit:ep,resetField:eb,getValues:ef,formState:eg}=(0,o.mN)(t),ej=(0,w.Ir)(),ey=(0,w.Zm)(),eS=(0,w.PQ)();es[7]!==el.id||es[8]!==ej||es[9]!==eo||es[10]!==ei||es[11]!==ey?(a=e=>{let t={...e,host:(0,C.KL)(e.host),hyperdxSettingPrefix:e.hyperdxSettingPrefix||null};if(eo){let{id:e,...a}=t;ej.mutate({connection:a},{onSuccess:()=>{f.$e.show({color:"green",message:"Connection created successfully"}),ei?.()},onError:T})}else ey.mutate({connection:t,id:el.id},{onSuccess:()=>{f.$e.show({color:"green",message:"Connection updated successfully"}),ei?.()},onError:z})},es[7]=el.id,es[8]=ej,es[9]=eo,es[10]=ei,es[11]=ey,es[12]=a):a=es[12];let ev=a,[ew,eC]=(0,l.useState)(!1),[eE,eN]=(0,l.useState)(!1);es[13]!==ef?(n={getValues:ef},es[13]=ef,es[14]=n):n=es[14];let{testConnectionState:e_,handleTestConnection:ez}=function({getValues:e}){let t=y.Ay.useTestConnection(),[a,n]=(0,l.useState)(null),r=(0,l.useCallback)(async()=>{let r=e("host"),s=e("username"),l=e("password"),o=(0,C.KL)(r);if(!a){if(n("loading"),v.VO)try{await (0,i.Kc)({host:o,username:s,password:l})?n("valid"):(n("invalid"),f.$e.show({color:"red",message:"Connection test failed",autoClose:5e3}))}catch(e){console.error(e),n("invalid"),f.$e.show({color:"red",message:e.message,autoClose:5e3})}else try{let e=await t.mutateAsync({host:o,username:s,password:l});e.success?n("valid"):(n("invalid"),f.$e.show({color:"red",message:e.error||"Connection test failed",autoClose:5e3}))}catch(t){let e=await t.response?.json();n("invalid"),f.$e.show({color:"red",message:e?.error??"Failed to test connection",autoClose:5e3})}setTimeout(()=>{n(null)},2e3)}},[e,t,a]);return{testConnectionState:a,handleTestConnection:r}}(n);es[15]!==ep||es[16]!==ev?(N=e=>{e.preventDefault(),ep(e=>{ev(e)})()},es[15]=ep,es[16]=ev,es[17]=N):N=es[17],es[18]===Symbol.for("react.memo_cache_sentinel")?(_=(0,r.jsx)(c.E,{size:"xs",mb:"xs",children:"Connection Name"}),es[18]=_):_=es[18],es[19]===Symbol.for("react.memo_cache_sentinel")?(A={required:"Connection name is required"},es[19]=A):A=es[19],es[20]!==ex?($=(0,r.jsxs)(d.a,{children:[_,(0,r.jsx)(S.t4,{"data-testid":"connection-name-input",name:"name",control:ex,placeholder:"My Clickhouse Server",rules:A})]}),es[20]=ex,es[21]=$):$=es[21],es[22]===Symbol.for("react.memo_cache_sentinel")?(k=(0,r.jsx)(c.E,{size:"xs",mb:"xs",children:"Host"}),es[22]=k):k=es[22],es[23]===Symbol.for("react.memo_cache_sentinel")?(I={required:"Host is required"},es[23]=I):I=es[23],es[24]!==ex?(F=(0,r.jsxs)(d.a,{children:[k,(0,r.jsx)(S.t4,{"data-testid":"connection-host-input",name:"host",control:ex,placeholder:"http://localhost:8123",rules:I})]}),es[24]=ex,es[25]=F):F=es[25],es[26]===Symbol.for("react.memo_cache_sentinel")?(H=(0,r.jsx)(c.E,{size:"xs",mb:"xs",children:"Username"}),es[26]=H):H=es[26],es[27]!==ex?(L=(0,r.jsxs)(d.a,{children:[H,(0,r.jsx)(S.t4,{"data-testid":"connection-username-input",name:"username",control:ex,placeholder:"Username (default: default)"})]}),es[27]=ex,es[28]=L):L=es[28],es[29]===Symbol.for("react.memo_cache_sentinel")?(V=(0,r.jsx)(c.E,{size:"xs",mb:"xs",children:"Password"}),es[29]=V):V=es[29],es[30]!==eo||es[31]!==ew?(D=!ew&&!eo&&(0,r.jsx)(m.$,{"data-testid":"update-password-button",variant:"secondary",onClick:()=>{eC(!0)},children:"Update Password"}),es[30]=eo,es[31]=ew,es[32]=D):D=es[32],es[33]!==ex||es[34]!==eo||es[35]!==eb||es[36]!==ew?(M=(ew||eo)&&(0,r.jsxs)(u.s,{align:"center",gap:"sm",children:[(0,r.jsx)(S.aJ,{"data-testid":"connection-password-input",style:{flexGrow:1},name:"password",control:ex,placeholder:"Password (default: blank)"}),!eo&&(0,r.jsx)(m.$,{"data-testid":"cancel-password-button",variant:"secondary",onClick:()=>{eC(!1),eb("password")},children:"Cancel"})]}),es[33]=ex,es[34]=eo,es[35]=eb,es[36]=ew,es[37]=M):M=es[37],es[38]!==D||es[39]!==M?(Z=(0,r.jsxs)(d.a,{children:[V,D,M]}),es[38]=D,es[39]=M,es[40]=Z):Z=es[40],es[41]!==eE?(q=!eE&&(0,r.jsx)(h.M,{underline:"always",onClick:()=>eN(!0),size:"xs",children:(0,r.jsxs)(x.Y,{gap:"xs",children:[(0,r.jsx)(g.A,{size:14}),"Advanced Settings"]})}),es[41]=eE,es[42]=q):q=es[42],es[43]!==eE?(O=eE&&(0,r.jsx)(m.$,{onClick:()=>eN(!1),size:"xs",variant:"subtle",children:"Hide Advanced Settings"}),es[43]=eE,es[44]=O):O=es[44],es[45]!==q||es[46]!==O?(G=(0,r.jsxs)(d.a,{children:[q,O]}),es[45]=q,es[46]=O,es[47]=G):G=es[47];let eT=eE?"block":"none";es[48]!==eT?(B={display:eT},es[48]=eT,es[49]=B):B=es[49],es[50]===Symbol.for("react.memo_cache_sentinel")?(R=(0,r.jsx)(c.E,{size:"xs",children:"Query Log Setting Prefix"}),es[50]=R):R=es[50],es[51]===Symbol.for("react.memo_cache_sentinel")?(P=(0,r.jsxs)(x.Y,{gap:"xs",mb:"xs",children:[R,(0,r.jsx)(p.m,{label:"Tracks query origins by adding the current user's email to ClickHouse queries (as {prefix}_user in system.query_log). Requires 'custom_settings_prefixes' in your ClickHouse config.xml to include this exact value, otherwise queries will be rejected.",color:"dark",c:"white",multiline:!0,maw:400,children:(0,r.jsx)(j.A,{size:16,className:"cursor-pointer"})})]}),es[51]=P):P=es[51],es[52]!==ex?(Y=(0,r.jsx)(S.t4,{"data-testid":"connection-setting-prefix-input",name:"hyperdxSettingPrefix",control:ex,placeholder:"hyperdx"}),es[52]=ex,es[53]=Y):Y=es[53],es[54]!==B||es[55]!==Y?(K=(0,r.jsxs)(d.a,{style:B,children:[P,Y]}),es[54]=B,es[55]=Y,es[56]=K):K=es[56];let eA=!eg.isValid,e$="invalid"===e_?"danger":"secondary",ek="loading"===e_;es[57]!==e_?(W="valid"===e_?(0,r.jsx)(r.Fragment,{children:"Connection successful"}):"invalid"===e_?(0,r.jsx)(r.Fragment,{children:"Unable to connect"}):"Test Connection",es[57]=e_,es[58]=W):W=es[58],es[59]!==ez||es[60]!==eA||es[61]!==e$||es[62]!==ek||es[63]!==W?(X=(0,r.jsx)(m.$,{disabled:eA,variant:e$,type:"button",onClick:ez,loading:ek,children:W}),es[59]=ez,es[60]=eA,es[61]=e$,es[62]=ek,es[63]=W,es[64]=X):X=es[64],es[65]!==eo||es[66]!==X?(U=(0,r.jsx)(p.m,{label:"\uD83D\uDD12 Password re-entry required for security",position:"right",disabled:eo,withArrow:!0,children:X}),es[65]=eo,es[66]=X,es[67]=U):U=es[67],es[68]!==ec||es[69]!==eu?(Q=ec&&eu&&(0,r.jsx)(m.$,{variant:"secondary",onClick:ec,children:"Cancel"}),es[68]=ec,es[69]=eu,es[70]=Q):Q=es[70],es[71]!==el.id||es[72]!==eS||es[73]!==eo||es[74]!==ec||es[75]!==eh?(J=!eo&&!1!==eh&&(0,r.jsx)(E.A,{onDelete:()=>eS.mutate({id:el.id},{onSuccess:()=>{ec?.()}})}),es[71]=el.id,es[72]=eS,es[73]=eo,es[74]=ec,es[75]=eh,es[76]=J):J=es[76];let eI=eo?ej.isPending:ey.isPending,eF=eo?"Create":"Save";return es[77]!==eI||es[78]!==eF?(ee=(0,r.jsxs)(m.$,{"data-testid":"connection-save-button",variant:"primary",type:"submit",loading:eI,children:[eF," Connection"]}),es[77]=eI,es[78]=eF,es[79]=ee):ee=es[79],es[80]!==Q||es[81]!==J||es[82]!==ee?(et=(0,r.jsxs)(x.Y,{gap:"xs",children:[Q,J,ee]}),es[80]=Q,es[81]=J,es[82]=ee,es[83]=et):et=es[83],es[84]!==U||es[85]!==et?(ea=(0,r.jsxs)(x.Y,{justify:"space-between",children:[U,et]}),es[84]=U,es[85]=et,es[86]=ea):ea=es[86],es[87]!==F||es[88]!==L||es[89]!==Z||es[90]!==G||es[91]!==K||es[92]!==ea||es[93]!==$?(en=(0,r.jsxs)(b.B,{gap:"md",children:[$,F,L,Z,G,K,ea]}),es[87]=F,es[88]=L,es[89]=Z,es[90]=G,es[91]=K,es[92]=ea,es[93]=$,es[94]=en):en=es[94],es[95]!==en||es[96]!==N?(er=(0,r.jsx)("form",{"data-testid":"connection-form",onSubmit:N,children:en}),es[95]=en,es[96]=N,es[97]=er):er=es[97],er}function z(){f.$e.show({color:"red",message:"Error updating connection, please check the host and credentials and try again.",autoClose:5e3})}function T(){f.$e.show({color:"red",message:"Error creating connection, please check the host and credentials and try again.",autoClose:5e3})}},52154:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var n=a(6029),r=a(75155),s=a(43517),l=a(78253);function o(e){let t,a,o,i,c,d,m,u=(0,r.c)(17),{language:h,onLanguageChange:x,showHotkey:p}=e;u[0]!==p?(t=p&&(0,n.jsx)(s.E,{size:"xxs",bg:"var(--color-bg-neutral)",c:"white",px:4,py:0,mr:4,lh:1.4,children:"/"}),u[0]=p,u[1]=t):t=u[1];let b="sql"===h?"var(--color-text-brand)":"gray";u[2]!==x?(a=()=>x("sql"),u[2]=x,u[3]=a):a=u[3],u[4]!==b||u[5]!==a?(o=(0,n.jsx)(s.E,{c:b,onClick:a,size:"xs",role:"button",children:"SQL"}),u[4]=b,u[5]=a,u[6]=o):o=u[6],u[7]===Symbol.for("react.memo_cache_sentinel")?(i=(0,n.jsx)(s.E,{size:"xs",children:"|"}),u[7]=i):i=u[7];let f="lucene"===h?"var(--color-text-brand)":"gray";return u[8]!==x?(c=()=>x("lucene"),u[8]=x,u[9]=c):c=u[9],u[10]!==f||u[11]!==c?(d=(0,n.jsx)(s.E,{size:"xs",role:"button",fw:500,c:f,onClick:c,children:"Lucene"}),u[10]=f,u[11]=c,u[12]=d):d=u[12],u[13]!==t||u[14]!==o||u[15]!==d?(m=(0,n.jsxs)(l.s,{wrap:"nowrap",gap:"xxxs",px:"sm",children:[t,o,i,d]}),u[13]=t,u[14]=o,u[15]=d,u[16]=m):m=u[16],m}},54970:(e,t,a)=>{"use strict";a.d(t,{v:()=>I});var n=a(6029),r=a(75155),s=a(55729),l=a(82641),o=a(62801),i=a(78253),c=a(94720),d=a(43517),m=a(25062),u=a(39603),h=a(92556),x=a(3635),p=a(76013),b=a(60481),f=a(92789),g=a(34834),j=a(28797),y=a(94502),S=a(17283),v=a(91758),w=a(58333),C=a(23474),E=a(23195),N=a(98142),_=a(93108),z=a(81973),T=a(92917),A=a(24314),$=a(76326),k=a.n($);function I(e){let t,a,$,I,F,H,L,V,D=(0,r.c)(53),{onAddSource:M,withCard:Z,withBorder:q,cardClassName:O,variant:G,showEmptyState:B}=e,R=void 0===Z||Z,P=void 0===q||q,Y=void 0===G?"compact":G,K=void 0===B||B,{data:W,isLoading:X,error:U,refetch:Q}=(0,_.ZY)(),{data:J,isLoading:ee,error:et,refetch:ea}=(0,z.oE)(),[en,er]=(0,s.useState)(null),[es,el]=(0,s.useState)(!1),eo=U||et;D[0]!==Q||D[1]!==ea?(t=()=>{Q(),ea()},D[0]=Q,D[1]=ea,D[2]=t):t=D[2];let ei=t,ec="compact"===Y?"sm":"md",ed="compact"===Y?"xs":"sm",em="compact"===Y?11:14,eu="compact"===Y?"xs":"sm",eh=R?o.Z:s.Fragment;D[3]!==O||D[4]!==P||D[5]!==R?(a=R?{withBorder:P,p:"md",radius:"sm",className:O??k().sourcesCard}:{},D[3]=O,D[4]=P,D[5]=R,D[6]=a):a=D[6];let ex=a;if(X||ee){let e,t;return D[7]===Symbol.for("react.memo_cache_sentinel")?(e=(0,n.jsxs)(i.s,{justify:"center",align:"center",py:"xl",children:[(0,n.jsx)(c.a,{size:"sm"}),(0,n.jsx)(d.E,{size:"sm",c:"dimmed",ml:"sm",children:"Loading sources..."})]}),D[7]=e):e=D[7],D[8]!==eh||D[9]!==ex?(t=(0,n.jsx)(eh,{...ex,children:e}),D[8]=eh,D[9]=ex,D[10]=t):t=D[10],t}if(eo){let e,t,a,r,s,l;D[11]===Symbol.for("react.memo_cache_sentinel")?(e=(0,n.jsx)(j.A,{size:16}),D[11]=e):e=D[11];let o=eo instanceof Error?eo.message:"An error occurred while loading data sources.";return D[12]!==o?(t=(0,n.jsx)(d.E,{size:"sm",mb:"sm",children:o}),D[12]=o,D[13]=t):t=D[13],D[14]===Symbol.for("react.memo_cache_sentinel")?(a=(0,n.jsx)(y.A,{size:14}),D[14]=a):a=D[14],D[15]!==ei?(r=(0,n.jsx)(m.$,{size:"xs",variant:"danger",leftSection:a,onClick:ei,children:"Retry"}),D[15]=ei,D[16]=r):r=D[16],D[17]!==r||D[18]!==t?(s=(0,n.jsxs)(u.F,{icon:e,title:"Failed to load sources",color:"red",variant:"light",children:[t,r]}),D[17]=r,D[18]=t,D[19]=s):s=D[19],D[20]!==eh||D[21]!==s||D[22]!==ex?(l=(0,n.jsx)(eh,{...ex,children:s}),D[20]=eh,D[21]=s,D[22]=ex,D[23]=l):l=D[23],l}let ep=!J||0===J.length;return D[24]!==es||D[25]!==ep||D[26]!==K?($=ep&&!es&&K&&(0,n.jsxs)(i.s,{direction:"column",align:"center",py:"xl",gap:"sm",children:[(0,n.jsx)(S.A,{size:32,color:"var(--color-text-muted)"}),(0,n.jsx)(h.h,{size:"sm",ta:"center",c:"var(--color-text-muted)",children:"No data sources configured yet."}),(0,n.jsx)(d.E,{size:"xs",ta:"center",c:"var(--color-text-muted)",children:"Add a source to start querying your data."})]}),D[24]=es,D[25]=ep,D[26]=K,D[27]=$):$=D[27],D[28]!==eu||D[29]!==W||D[30]!==en||D[31]!==em||D[32]!==J||D[33]!==ed||D[34]!==ec?(I=J?.map((e,t)=>(0,n.jsxs)(s.Fragment,{children:[(0,n.jsxs)(i.s,{justify:"space-between",align:"center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(d.E,{size:ec,fw:500,children:e.name}),(0,n.jsx)(d.E,{size:ed,c:"dimmed",mt:4,children:(0,n.jsxs)(x.Y,{gap:"xs",children:[(0,T.Zr)(e.kind),(0,n.jsxs)(x.Y,{gap:4,children:[(0,n.jsx)(v.A,{size:em}),W?.find(t=>t.id===e.connection)?.name]}),(0,n.jsx)(x.Y,{gap:4,children:e.from&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(S.A,{size:em}),e.from.databaseName,e.kind===l.GL.Metric?"":".",e.from.tableName]})})]})})]}),(0,n.jsx)(p.M,{variant:"secondary",size:eu,onClick:()=>er(en===e.id?null:e.id),children:en===e.id?(0,n.jsx)(w.A,{size:em+2}):(0,n.jsx)(C.A,{size:em+2})})]}),en===e.id&&(0,n.jsx)(b.a,{mt:"xs",children:(0,n.jsx)(A.Eb,{sourceId:e.id,onSave:()=>er(null)})}),t<(J?.length??0)-1&&(0,n.jsx)(f.c,{})]},e.id)),D[28]=eu,D[29]=W,D[30]=en,D[31]=em,D[32]=J,D[33]=ed,D[34]=ec,D[35]=I):I=D[35],D[36]!==es||D[37]!==J?(F=es&&(0,n.jsxs)(n.Fragment,{children:[J&&J.length>0&&(0,n.jsx)(f.c,{}),(0,n.jsx)(A.Eb,{isNew:!0,onCreate:()=>el(!1),onCancel:()=>el(!1)})]}),D[36]=es,D[37]=J,D[38]=F):F=D[38],D[39]!==eu||D[40]!==es||D[41]!==M||D[42]!==J?(H=!N.VO&&!es&&(0,n.jsx)(i.s,{justify:"flex-end",pt:J&&J.length>0?"md":0,children:(0,n.jsx)(m.$,{variant:"secondary",size:eu,leftSection:(0,n.jsx)(E.A,{size:14}),onClick:()=>{el(!0),M?.()},children:"Add source"})}),D[39]=eu,D[40]=es,D[41]=M,D[42]=J,D[43]=H):H=D[43],D[44]!==H||D[45]!==$||D[46]!==I||D[47]!==F?(L=(0,n.jsxs)(g.B,{gap:"md",children:[$,I,F,H]}),D[44]=H,D[45]=$,D[46]=I,D[47]=F,D[48]=L):L=D[48],D[49]!==eh||D[50]!==L||D[51]!==ex?(V=(0,n.jsx)(eh,{...ex,children:L}),D[49]=eh,D[50]=L,D[51]=ex,D[52]=V):V=D[52],V}},62453:(e,t,a)=>{"use strict";a.d(t,{r:()=>i});var n=a(6029),r=a(75155),s=a(91758),l=a(9211),o=a(93108);function i(e){let t,a,i,d,m,u,h=(0,r.c)(11);h[0]!==e?({size:a,...t}=e,h[0]=e,h[1]=t,h[2]=a):(t=h[1],a=h[2]);let{data:x}=(0,o.ZY)();h[3]!==x?(i=x?.map(c),h[3]=x,h[4]=i):i=h[4];let p=i;return h[5]===Symbol.for("react.memo_cache_sentinel")?(d={withinPortal:!1},h[5]=d):d=h[5],h[6]===Symbol.for("react.memo_cache_sentinel")?(m=(0,n.jsx)(s.A,{size:16}),h[6]=m):m=h[6],h[7]!==t||h[8]!==a||h[9]!==p?(u=(0,n.jsx)(l.A,{...t,allowDeselect:!1,data:p,comboboxProps:d,searchable:!0,placeholder:"Connection",leftSection:m,maxDropdownHeight:280,size:a}),h[7]=t,h[8]=a,h[9]=p,h[10]=u):u=h[10],u}function c(e){return{value:e.id,label:e.name}}},64467:(e,t,a)=>{"use strict";a.d(t,{Z:()=>w});var n=a(6029),r=a(75155),s=a(55729),l=a(1909),o=a(66692),i=a(95516),c=a(15215),d=a(36417),m=a(22623),u=a(43517),h=a(63085),x=a(78253),p=a(67747),b=a(95352),f=a(78550),g=a(92917),j=a(52154);let y="150px",S={lineNumbers:!1,foldGutter:!1,highlightActiveLine:!1,highlightActiveLineGutter:!1};function v({tableConnection:e,tableConnections:t,filterField:a,onChange:r,placeholder:l,onLanguageChange:v,language:w,onSubmit:C,error:E,value:N,size:_,label:z,disableKeywordAutocomplete:T,enableHotkey:A,tooltipText:$,additionalSuggestions:k=[],queryHistoryType:I,parentRef:F,allowMultiline:H=!1}){let{colorScheme:L}=(0,d.C)(),{data:V}=(0,f.Sh)((e?[e]:t)??[]),D=(0,s.useMemo)(()=>a?V?.filter(a):V,[V,a]),[M,Z]=(0,g.mk)(I),q=(0,s.useCallback)((e,t,a,n)=>{e.dispatch({changes:{from:t,to:a,insert:n}}),(0,i.N)(e),Z(n),C&&C()},[C,Z]),O=(0,s.useMemo)(()=>()=>({from:0,options:M.map(e=>({label:e,section:"Search History",type:"keyword",apply:(t,a,n,r)=>{q(t,n,r,e)}}))}),[M,q]),[G,B]=(0,s.useState)(!1),R=(0,s.useRef)(null),P=(0,s.useRef)(new b.xx),Y=(0,s.useCallback)(e=>{let t=e.state.doc.toString(),a=[...D?.map(e=>e.path.length>1?`${e.path[0]}['${e.path[1]}']`:e.path[0])??[],...k],n=(0,c.ll)({dialect:c.fy.define({keywords:a.join(" ")+(T?"":" AND OR NOT IN LIKE ILIKE BETWEEN ASC DESC intDiv intDivOrZero isNaN moduloOrZero abs empty notEmpty length arrayConcat has hasAll hasAny indexOf arrayCount countEqual arrayUnion arrayIntersect arrayMap arrayFilter arraySort flatten arrayCompact arrayMin arrayMax arraySum arrayAvg if multiIf floor ceiling truncate round timestamp toTimeZone toYear toMonth toWeek toDayOfYear toDayOfMonth toDayOfWeek toUnixTimestamp toTime lower upper substring trim dictGet dictGetOrDefault dictGetOrNull")})}),r=(0,i.yU)({compareCompletions:(e,t)=>0,override:[O]});e.dispatch({effects:P.current.reconfigure(t.length>0?n:r)})},[D,k,O,T]);(0,s.useEffect)(()=>{null!=R.current&&null!=R.current.view&&Y(R.current.view)},[Y]),(0,o.vC)("/",()=>{A&&R.current?.view?.focus()},{preventDefault:!0},[A]);let K=(0,s.useMemo)(()=>null==F?[]:[(0,b.vX)({parent:F,tooltipSpace:e=>{let t=e.dom.getBoundingClientRect(),a=F.getBoundingClientRect();return{...t,right:t.right??0,left:a.left??t.left,top:a.top??t.top,bottom:a.bottom??t.bottom}}})],[F]),W=(0,s.useMemo)(()=>[...K,b.Lz.baseTheme({"&.cm-editor.cm-focused":{outline:"0px solid transparent"},"&.cm-editor":{background:"transparent !important"},".cm-editor-multiline &.cm-editor":{maxHeight:y},"& .cm-tooltip-autocomplete":{whiteSpace:"nowrap",wordWrap:"break-word",maxWidth:"100%",backgroundColor:"var(--color-bg-field) !important",border:"1px solid var(--color-border) !important",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)",padding:"4px"},"& .cm-tooltip-autocomplete > ul":{fontFamily:"inherit",maxHeight:"300px"},"& .cm-tooltip-autocomplete > ul > li":{padding:"4px 8px",borderRadius:"4px",cursor:"pointer",color:"var(--color-text)"},"& .cm-tooltip-autocomplete > ul > li[aria-selected]":{backgroundColor:"var(--color-bg-field-highlighted) !important",color:"var(--color-text-muted) !important"},"& .cm-tooltip-autocomplete .cm-completionLabel":{color:"var(--color-text)"},"& .cm-tooltip-autocomplete .cm-completionDetail":{color:"var(--color-text-muted)",fontStyle:"normal",marginLeft:"8px"},"& .cm-tooltip-autocomplete .cm-completionInfo":{backgroundColor:"var(--color-bg-field)",border:"1px solid var(--color-border)",borderRadius:"4px",padding:"8px",color:"var(--color-text)"},"& .cm-completionIcon":{width:"16px",marginRight:"6px",opacity:.7},"& .cm-scroller":{overflowX:"hidden"},".cm-editor-multiline & .cm-scroller":{maxHeight:y,overflowY:"auto"}}),...H?[b.Lz.lineWrapping]:[],P.current.of((0,c.ll)({upperCaseKeywords:!0})),b.Nb.highest(b.w4.of([{key:"Enter",run:e=>null!=C&&(I&&R?.current?.view&&Z(R?.current?.view.state.doc.toString()),C(),!0)},...H?[{key:"Shift-Enter",run:()=>!1}]:[]])),b.w4.of([{key:"Tab",run:i.$w}])],[H,C,I,Z,K]),X=(0,s.useCallback)(()=>{R?.current?.view&&(0,i.rB)(R.current.view)},[]);return(0,n.jsxs)(m.t,{flex:"auto",shadow:"none",style:{backgroundColor:"var(--color-bg-field)",border:`1px solid ${E?"var(--color-bg-danger)":"var(--color-border)"}`,display:"flex",alignItems:"center",minHeight:"xs"===_?30:36},ps:"4px",children:[null!=z&&(0,n.jsx)(u.E,{mx:"4px",size:"xs",fw:"bold",style:{whiteSpace:"nowrap"},component:"div",children:(0,n.jsx)(h.m,{label:$,disabled:!$,children:(0,n.jsxs)(x.s,{align:"center",gap:2,children:[z,$&&(0,n.jsx)(p.A,{size:20})]})})}),(0,n.jsx)("div",{style:{minWidth:10,width:"100%"},className:H?"cm-editor-multiline":"",children:(0,n.jsx)(b.Ay,{indentWithTab:!1,ref:R,value:N,onChange:r,theme:"dark"===L?"dark":"light",onFocus:(0,s.useCallback)(()=>{B(!0)},[B]),onBlur:(0,s.useCallback)(()=>{B(!1)},[B]),extensions:W,onCreateEditor:Y,basicSetup:S,placeholder:l,onClick:X})}),null!=v&&null!=w&&(0,n.jsx)(j.A,{showHotkey:A&&G,language:w,onLanguageChange:v})]})}let w=(0,s.memo)(function(e){let t,a,s,o,i,c,d=(0,r.c)(15);d[0]!==e?({placeholder:s,filterField:a,additionalSuggestions:t,queryHistoryType:i,...o}=e,d[0]=e,d[1]=t,d[2]=a,d[3]=s,d[4]=o,d[5]=i):(t=d[1],a=d[2],s=d[3],o=d[4],i=d[5]);let{field:m,fieldState:u}=(0,l.as)(o),h=m.value||o.defaultValue,x="";"string"==typeof h?x=h:void 0!==h&&console.error("SQLInlineEditor: value is not a string",h);let p=u.error?.message;return d[6]!==t||d[7]!==m.onChange||d[8]!==a||d[9]!==s||d[10]!==o||d[11]!==i||d[12]!==x||d[13]!==p?(c=(0,n.jsx)(v,{filterField:a,onChange:m.onChange,placeholder:s,value:x,error:p,additionalSuggestions:t,queryHistoryType:i,...o}),d[6]=t,d[7]=m.onChange,d[8]=a,d[9]=s,d[10]=o,d[11]=i,d[12]=x,d[13]=p,d[14]=c):c=d[14],c})},71781:(e,t,a)=>{"use strict";a.d(t,{M7:()=>d,aJ:()=>u,mh:()=>h,t4:()=>m});var n=a(6029),r=a(75155);a(55729);var s=a(1909),l=a(59029),o=a(96061),i=a(45544),c=a(47268);function d(e){let t,a,o,i,c,d,m=(0,r.c)(12);return m[0]!==e?({name:a,control:t,rules:i,...o}=e,m[0]=e,m[1]=t,m[2]=a,m[3]=o,m[4]=i):(t=m[1],a=m[2],o=m[3],i=m[4]),m[5]!==o?(c=e=>{let{field:t,fieldState:a}=e,{error:r}=a;return(0,n.jsx)(l.k,{...o,...t,error:r?.message})},m[5]=o,m[6]=c):c=m[6],m[7]!==t||m[8]!==a||m[9]!==i||m[10]!==c?(d=(0,n.jsx)(s.xI,{name:a,control:t,rules:i,render:c}),m[7]=t,m[8]=a,m[9]=i,m[10]=c,m[11]=d):d=m[11],d}function m(e){let t,a,l,i,c,d,m=(0,r.c)(12);return m[0]!==e?({name:a,control:t,rules:i,...l}=e,m[0]=e,m[1]=t,m[2]=a,m[3]=l,m[4]=i):(t=m[1],a=m[2],l=m[3],i=m[4]),m[5]!==l?(c=e=>{let{field:t,fieldState:a}=e,{error:r}=a;return(0,n.jsx)(o.p,{...l,...t,error:r?.message})},m[5]=l,m[6]=c):c=m[6],m[7]!==t||m[8]!==a||m[9]!==i||m[10]!==c?(d=(0,n.jsx)(s.xI,{name:a,control:t,rules:i,render:c}),m[7]=t,m[8]=a,m[9]=i,m[10]=c,m[11]=d):d=m[11],d}function u(e){let t,a,l,o,c,d,m=(0,r.c)(12);return m[0]!==e?({name:a,control:t,rules:o,...l}=e,m[0]=e,m[1]=t,m[2]=a,m[3]=l,m[4]=o):(t=m[1],a=m[2],l=m[3],o=m[4]),m[5]!==l?(c=e=>{let{field:t,fieldState:a}=e,{error:r}=a;return(0,n.jsx)(i.y,{...l,...t,error:r?.message})},m[5]=l,m[6]=c):c=m[6],m[7]!==t||m[8]!==a||m[9]!==o||m[10]!==c?(d=(0,n.jsx)(s.xI,{name:a,control:t,rules:o,render:c}),m[7]=t,m[8]=a,m[9]=o,m[10]=c,m[11]=d):d=m[11],d}function h(e){let t,a,l,o,i,d,m=(0,r.c)(12);return m[0]!==e?({name:a,control:t,rules:o,...l}=e,m[0]=e,m[1]=t,m[2]=a,m[3]=l,m[4]=o):(t=m[1],a=m[2],l=m[3],o=m[4]),m[5]!==l?(i=e=>{let{field:t,fieldState:a}=e,{value:r,...s}=t,{error:o}=a;return(0,n.jsx)(c.S,{...l,...s,checked:r,error:o?.message})},m[5]=l,m[6]=i):i=m[6],m[7]!==t||m[8]!==a||m[9]!==o||m[10]!==i?(d=(0,n.jsx)(s.xI,{name:a,control:t,rules:o,render:i}),m[7]=t,m[8]=a,m[9]=o,m[10]=i,m[11]=d):d=m[11],d}},76326:e=>{e.exports={sourcesCard:"Sources_sourcesCard__m5aMQ"}},86761:(e,t,a)=>{"use strict";a.d(t,{A:()=>j});var n=a(6029),r=a(75155),s=a(55729),l=a(82641),o=a(43517),i=a(63085),c=a(22623),d=a(27166),m=a(64488),u=a(6620),h=a(94502),x=a(78550),p=a(88339);let b=e=>{let t,a,s,l=(0,r.c)(11),{onClick:c,isEnabled:d,tableCount:m,iconStyles:h,variant:x}=e,p=void 0===x?"icon":x,b=d?m>1?"Show Table Schemas":"Show Table Schema":"Select a table to view its schema";return l[0]!==d||l[1]!==c?(t=()=>d&&c(),l[0]=d,l[1]=c,l[2]=t):t=l[2],l[3]!==h||l[4]!==d||l[5]!==p?(a="text"===p?(0,n.jsx)(o.E,{fw:500,size:"xs",className:"text-sucess-hover",style:{cursor:d?"pointer":"default",...h},children:"Schema"}):(0,n.jsx)(u.A,{size:16}),l[3]=h,l[4]=d,l[5]=p,l[6]=a):a=l[6],l[7]!==t||l[8]!==a||l[9]!==b?(s=(0,n.jsx)(i.m,{label:b,color:"dark",position:"right",onClick:t,children:a}),l[7]=t,l[8]=a,l[9]=b,l[10]=s):s=l[10],s},f=e=>{let t,a,s,l=(0,r.c)(8),{databaseName:o,tableName:i,connectionId:d}=e;l[0]!==d||l[1]!==o||l[2]!==i?(t={databaseName:o,tableName:i,connectionId:d},l[0]=d,l[1]=o,l[2]=i,l[3]=t):t=l[3];let{data:m,isLoading:u}=(0,x.Z2)(t);return l[4]===Symbol.for("react.memo_cache_sentinel")?(a={overflow:"hidden"},l[4]=a):a=l[4],l[5]!==m?.create_table_query||l[6]!==u?(s=(0,n.jsx)(c.t,{flex:"auto",shadow:"none",radius:"sm",p:"xs",style:a,children:u?(0,n.jsx)("div",{className:"d-inline-block",children:(0,n.jsx)(h.A,{className:"spin-animate"})}):(0,n.jsx)(p.V,{data:m?.create_table_query??"Schema is not available",enableCopy:!!m?.create_table_query,copyButtonSize:"xs"})}),l[5]=m?.create_table_query,l[6]=u,l[7]=s):s=l[7],s},g={[l.SX.Sum]:"Sum",[l.SX.Gauge]:"Gauge",[l.SX.Histogram]:"Histogram",[l.SX.Summary]:"Summary",[l.SX.ExponentialHistogram]:"Exponential Histogram"},j=e=>{let t,a,o,i,c,u=(0,r.c)(34),{source:h,iconStyles:x,variant:p}=e,f=void 0===p?"icon":p,[j,w]=(0,s.useState)(!1),C=h?.kind==="metric";if(u[0]!==C||u[1]!==h){let e,a;if(t=[],h&&C){let e,a,n;u[3]===Symbol.for("react.memo_cache_sentinel")?(e=Object.values(l.SX),u[3]=e):e=u[3],u[4]!==h?(a=e.map(e=>({metricType:e,tableName:h.metricTables?.[e]})).filter(y),u[4]=h,u[5]=a):a=u[5],u[6]!==h||u[7]!==a?(n=a.map(e=>{let{metricType:t,tableName:a}=e;return{databaseName:h.from.databaseName,tableName:a,connectionId:h.connection,title:g[t]}}),u[6]=h,u[7]=a,u[8]=n):n=u[8],t.push(...n)}else if(h&&h.from.tableName){let e,a=h.name??h.from.tableName;u[9]!==h.connection||u[10]!==h.from.databaseName||u[11]!==h.from.tableName||u[12]!==a?(e={databaseName:h.from.databaseName,tableName:h.from.tableName,connectionId:h.connection,title:a},u[9]=h.connection,u[10]=h.from.databaseName,u[11]=h.from.tableName,u[12]=a,u[13]=e):e=u[13],t.push(e)}u[14]!==h?.materializedViews?(e=h?.materializedViews??[],u[14]=h?.materializedViews,u[15]=e):e=u[15];let n=e;if(u[16]!==n||u[17]!==h){let e;u[19]!==h?(e=e=>{let{tableName:t,databaseName:a}=e;return{databaseName:a,tableName:t,connectionId:h.connection,title:`${t} (MV)`}},u[19]=h,u[20]=e):e=u[20],a=n.map(e),u[16]=n,u[17]=h,u[18]=a}else a=u[18];t.push(...a),u[0]=C,u[1]=h,u[2]=t}else t=u[2];let E=!!h&&t.length>0;return u[21]===Symbol.for("react.memo_cache_sentinel")?(a=()=>w(!0),u[21]=a):a=u[21],u[22]!==x||u[23]!==E||u[24]!==t.length||u[25]!==f?(o=(0,n.jsx)(b,{isEnabled:E,onClick:a,iconStyles:x,tableCount:t.length,variant:f}),u[22]=x,u[23]=E,u[24]=t.length,u[25]=f,u[26]=o):o=u[26],u[27]!==E||u[28]!==j||u[29]!==t?(i=E&&(0,n.jsx)(d.a,{opened:j,onClose:()=>w(!1),size:"auto",title:t.length>1?"Table Schemas":"Table Schema",children:(0,n.jsxs)(m.t,{defaultValue:`${t[0]?.databaseName}.${t[0]?.tableName}.${t[0]?.title}`,children:[(0,n.jsx)(m.t.List,{children:t.map(S)}),t.map(v)]})}),u[27]=E,u[28]=j,u[29]=t,u[30]=i):i=u[30],u[31]!==o||u[32]!==i?(c=(0,n.jsxs)(n.Fragment,{children:[o,i]}),u[31]=o,u[32]=i,u[33]=c):c=u[33],c};function y(e){let{tableName:t}=e;return!!t}function S(e){return(0,n.jsx)(m.t.Tab,{value:`${e.databaseName}.${e.tableName}.${e.title}`,children:e.title},`${e.databaseName}.${e.tableName}.${e.title}`)}function v(e){return(0,n.jsx)(m.t.Panel,{value:`${e.databaseName}.${e.tableName}.${e.title}`,pt:"sm",children:(0,n.jsx)(f,{...e})},`${e.databaseName}.${e.tableName}.${e.title}`)}}}]);