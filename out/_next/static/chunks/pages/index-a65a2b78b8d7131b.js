(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3332],{6876:(e,s,t)=>{"use strict";t.d(s,{Ay:()=>h,Q5:()=>d});var n=t(81278),a=t.n(n),o=t(62910),r=t(16932),i=t(12482),u=t(98142);let m=o.Ay.create({prefixUrl:"/api",credentials:"include",hooks:{afterResponse:[function(e,s,t){if(!["/","/forgot","/join-team","/login","/register","/reset-password"].includes(a().pathname)&&401===t.status){try{window.sessionStorage.setItem("hdx-login-redirect-url",a().asPath)}catch(e){console.error(e)}a().push("/login")}}]},timeout:!1}),d=(e,s)=>m(e,{...s}),h={useCreateAlert:()=>(0,r.n)({mutationFn:async e=>m("alerts",{method:"POST",json:e}).json()}),useUpdateAlert:()=>(0,r.n)({mutationFn:async e=>m(`alerts/${e.id}`,{method:"PUT",json:e}).json()}),useDeleteAlert:()=>(0,r.n)({mutationFn:async e=>m(`alerts/${e}`,{method:"DELETE"})}),useSilenceAlert:()=>(0,r.n)({mutationFn:async({alertId:e,mutedUntil:s})=>m(`alerts/${e}/silenced`,{method:"POST",json:{mutedUntil:s}})}),useUnsilenceAlert:()=>(0,r.n)({mutationFn:async e=>m(`alerts/${e}/silenced`,{method:"DELETE"})}),useDashboards:e=>(0,i.I)({queryKey:["dashboards"],queryFn:()=>u.VO?null:d("dashboards",{method:"GET"}).json(),...e}),useCreateDashboard:()=>(0,r.n)({mutationFn:async({name:e,charts:s,query:t,tags:n})=>d("dashboards",{method:"POST",json:{name:e,charts:s,query:t,tags:n}}).json()}),useUpdateDashboard:()=>(0,r.n)({mutationFn:async({id:e,name:s,charts:t,query:n,tags:a})=>d(`dashboards/${e}`,{method:"PUT",json:{name:s,charts:t,query:n,tags:a}}).json()}),useDeleteDashboard:()=>(0,r.n)({mutationFn:async({id:e})=>d(`dashboards/${e}`,{method:"DELETE"}).json()}),usePresetDashboardFilters:(e,s,t=!0)=>(0,i.I)({queryKey:["dashboards","preset",e,"filters",s],queryFn:()=>d(`dashboards/preset/${e}/filters/`,{method:"GET",searchParams:{sourceId:s}}).json(),enabled:!!s&&t}),useCreatePresetDashboardFilter:()=>(0,r.n)({mutationFn:async e=>d(`dashboards/preset/${e.presetDashboard}/filter`,{method:"POST",json:{filter:e}}).json()}),useUpdatePresetDashboardFilter:()=>(0,r.n)({mutationFn:async e=>d(`dashboards/preset/${e.presetDashboard}/filter`,{method:"PUT",json:{filter:e}}).json()}),useDeletePresetDashboardFilter:()=>(0,r.n)({mutationFn:async({id:e,presetDashboard:s})=>d(`dashboards/preset/${s}/filter/${e}`,{method:"DELETE"}).json()}),useAlerts:()=>(0,i.I)({queryKey:["alerts"],queryFn:()=>d("alerts").json()}),useServices:()=>(0,i.I)({queryKey:["services"],queryFn:()=>d("chart/services",{method:"GET"}).json()}),useRotateTeamApiKey:()=>(0,r.n)({mutationFn:async()=>d("team/apiKey",{method:"PATCH"}).json()}),useDeleteTeamMember:()=>(0,r.n)({mutationFn:async({userId:e})=>d(`team/member/${e}`,{method:"DELETE"}).json()}),useTeamInvitations:()=>(0,i.I)({queryKey:["team/invitations"],queryFn:()=>d("team/invitations").json()}),useSaveTeamInvitation:()=>(0,r.n)({mutationFn:async({name:e,email:s})=>d("team/invitation",{method:"POST",json:{name:e,email:s}}).json()}),useDeleteTeamInvitation:()=>(0,r.n)({mutationFn:async({id:e})=>d(`team/invitation/${e}`,{method:"DELETE"}).json()}),useInstallation:()=>(0,i.I)({queryKey:["installation"],queryFn:()=>{if(!u.VO)return d("installation").json()}}),useMe:()=>(0,i.I)({queryKey:["me"],queryFn:()=>u.VO?null:d("me").json()}),useTeam:()=>(0,i.I)({queryKey:["team"],queryFn:()=>u.VO?null:d("team").json(),retry:1}),useTeamMembers:()=>(0,i.I)({queryKey:["team/members"],queryFn:()=>d("team/members").json()}),useSetTeamName:()=>(0,r.n)({mutationFn:async({name:e})=>d("team/name",{method:"PATCH",json:{name:e}}).json()}),useUpdateClickhouseSettings:()=>(0,r.n)({mutationFn:async e=>d("team/clickhouse-settings",{method:"PATCH",json:e}).json()}),useTags:()=>(0,i.I)({queryKey:["team/tags"],queryFn:()=>d("team/tags").json()}),useSaveWebhook:()=>(0,r.n)({mutationFn:async({service:e,url:s,name:t,description:n,queryParams:a,headers:o,body:r})=>d("webhooks",{method:"POST",json:{name:t,service:e,url:s,description:n,queryParams:a||{},headers:o||{},body:r}}).json()}),useUpdateWebhook:()=>(0,r.n)({mutationFn:async({id:e,service:s,url:t,name:n,description:a,queryParams:o,headers:r,body:i})=>d(`webhooks/${e}`,{method:"PUT",json:{name:n,service:s,url:t,description:a,queryParams:o||{},headers:r||{},body:i}}).json()}),useWebhooks:e=>(0,i.I)({queryKey:[...e],queryFn:()=>d("webhooks",{method:"GET",searchParams:[...e.map(e=>["service",e])]}).json()}),useDeleteWebhook:()=>(0,r.n)({mutationFn:async({id:e})=>d(`webhooks/${e}`,{method:"DELETE"}).json()}),useTestWebhook:()=>(0,r.n)({mutationFn:async({service:e,url:s,queryParams:t,headers:n,body:a})=>d("webhooks/test",{method:"POST",json:{service:e,url:s,queryParams:t||{},headers:n||{},body:a}}).json()}),useRegisterPassword:()=>(0,r.n)({mutationFn:async({email:e,password:s,confirmPassword:t})=>d("register/password",{method:"POST",json:{email:e,password:s,confirmPassword:t}}).json()}),useTestConnection:()=>(0,r.n)({mutationFn:async({host:e,username:s,password:t})=>d("clickhouse-proxy/test",{method:"POST",json:{host:e,username:s,password:t}}).json()})}},17703:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(81052)}])},81052:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var n=t(6029),a=t(75155),o=t(55729),r=t(81278),i=t(6876);function u(){let e,s,t,r,u=(0,a.c)(7),{data:d}=i.Ay.useMe(),[h,l]=(0,o.useState)(0);return u[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>{let e=setInterval(()=>{l(m)},1e3);return()=>clearInterval(e)},s=[],u[0]=e,u[1]=s):(e=u[0],s=u[1]),(0,o.useEffect)(e,s),u[2]!==d||u[3]!==h?(t=null==d&&(0,n.jsxs)("div",{className:"bg-body fixed-top vh-100 vw-100 top-0 start-0 d-flex align-items-center justify-content-center",style:{zIndex:0x7fffffff},children:["Loading HyperDX",(0,n.jsx)("span",{style:{width:0},children:".".repeat(h)})]}),u[2]=d,u[3]=h,u[4]=t):t=u[4],u[5]!==t?(r=(0,n.jsx)(n.Fragment,{children:t}),u[5]=t,u[6]=r):r=u[6],r}function m(e){return(e+1)%4}var d=t(98142);let h=function(){let e,s,t,m,h,l=(0,a.c)(11),{data:c}=i.Ay.useInstallation(),{data:y,isLoading:j}=i.Ay.useTeam(),T=(0,r.useRouter)(),b=!!(!j&&y);return l[0]!==b||l[1]!==T?(e=()=>{(b||d.VO)&&T.push("/search")},s=[b,T],l[0]=b,l[1]=T,l[2]=e,l[3]=s):(e=l[2],s=l[3]),(0,o.useEffect)(e,s),l[4]!==c?.isTeamExisting||l[5]!==T?(t=()=>{c?.isTeamExisting===!0?T.push("/login"):c?.isTeamExisting===!1&&T.push("/register")},l[4]=c?.isTeamExisting,l[5]=T,l[6]=t):t=l[6],l[7]!==c||l[8]!==T?(m=[c,T],l[7]=c,l[8]=T,l[9]=m):m=l[9],(0,o.useEffect)(t,m),l[10]===Symbol.for("react.memo_cache_sentinel")?(h=(0,n.jsx)(u,{}),l[10]=h):h=l[10],h}}},e=>{e.O(0,[910,6593,636,8792],()=>e(e.s=17703)),_N_E=e.O()}]);